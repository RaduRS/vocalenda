
}
[2025-09-16T11:04:29.919Z] üè¢ Business config: Gents Barbershop
[2025-09-16T11:04:29.919Z] üìã Services count: 2
[2025-09-16T11:04:29.919Z] üåê Site URL: https://www.vocalenda.com
[2025-09-16T11:04:29.919Z] üîë Secret exists: true
üóìÔ∏è Getting available slots for: {
  "date": "2025-09-17"
}
üìÖ Business open on Wednesday
üìã Using default service: haircut (Duration: 30 minutes)
[2025-09-16T11:04:29.919Z] üåê About to make API call:
[2025-09-16T11:04:29.919Z] üîó API URL: https://www.vocalenda.com/api/calendar/availability?businessId=1bb3c552-053f-40c4-b3f2-bdb51af87b52&serviceId=4395775e-fa81-4a69-8425-e46c3853dea4&date=2025-09-17
[2025-09-16T11:04:29.919Z] üîë Secret exists: true
[2025-09-16T11:04:29.919Z] üè¢ Business ID: 1bb3c552-053f-40c4-b3f2-bdb51af87b52
[2025-09-16T11:04:29.919Z] üìã Service ID: 4395775e-fa81-4a69-8425-e46c3853dea4
[2025-09-16T11:04:29.919Z] üìÖ Date: 2025-09-17
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}...
Message string: {"type":"ConversationText","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}
[2025-09-16T11:04:30.198Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}
[2025-09-16T11:04:30.198Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."
}
[2025-09-16T11:04:30.198Z] === END PARSED JSON ===
[2025-09-16T11:04:30.198Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:30.198Z] üí≠ CONVERSATION_TEXT: One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM...
[2025-09-16T11:04:30.198Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM...
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}...
Message string: {"type":"History","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}
[2025-09-16T11:04:30.198Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."}
[2025-09-16T11:04:30.198Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM..."
}
[2025-09-16T11:04:30.198Z] === END PARSED JSON ===
[2025-09-16T11:04:30.198Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:30.198Z] üìú HISTORY: Message logged
[2025-09-16T11:04:30.198Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM...
[2025-09-16T11:04:30.198Z] üìù Added transcript: [AI] One moment while I check the availability for a haircut on Wednesday, the 17th at 3 PM...
[2025-09-16T11:04:30.198Z] üéµ Starting audio stream - feeding buffer
[2025-09-16T11:04:29.919Z] üì° API Response status: 200
[2025-09-16T11:04:29.919Z] üì° API Response ok: true
[2025-09-16T11:04:29.919Z] üìÖ Calendar API response: {
  "slots": [
    {
      "start": "2025-09-17T08:00:00.000Z",
      "end": "2025-09-17T08:30:00.000Z",
      "startTime": "09:00",
      "endTime": "09:30",
      "startTimeConversational": "9:00 AM",
      "endTimeConversational": "9:30 AM"
    },
    {
      "start": "2025-09-17T08:15:00.000Z",
      "end": "2025-09-17T08:45:00.000Z",
      "startTime": "09:15",
      "endTime": "09:45",
      "startTimeConversational": "9:15 AM",
      "endTimeConversational": "9:45 AM"
    },
    {
      "start": "2025-09-17T08:30:00.000Z",
      "end": "2025-09-17T09:00:00.000Z",
      "startTime": "09:30",
      "endTime": "10:00",
      "startTimeConversational": "9:30 AM",
      "endTimeConversational": "10:00 AM"
    },
    {
      "start": "2025-09-17T08:45:00.000Z",
      "end": "2025-09-17T09:15:00.000Z",
      "startTime": "09:45",
      "endTime": "10:15",
      "startTimeConversational": "9:45 AM",
      "endTimeConversational": "10:15 AM"
    },
    {
      "start": "2025-09-17T09:00:00.000Z",
      "end": "2025-09-17T09:30:00.000Z",
      "startTime": "10:00",
      "endTime": "10:30",
      "startTimeConversational": "10:00 AM",
      "endTimeConversational": "10:30 AM"
    },
    {
      "start": "2025-09-17T09:15:00.000Z",
      "end": "2025-09-17T09:45:00.000Z",
      "startTime": "10:15",
      "endTime": "10:45",
      "startTimeConversational": "10:15 AM",
      "endTimeConversational": "10:45 AM"
    },
    {
      "start": "2025-09-17T09:30:00.000Z",
      "end": "2025-09-17T10:00:00.000Z",
      "startTime": "10:30",
      "endTime": "11:00",
      "startTimeConversational": "10:30 AM",
      "endTimeConversational": "11:00 AM"
    },
    {
      "start": "2025-09-17T09:45:00.000Z",
      "end": "2025-09-17T10:15:00.000Z",
      "startTime": "10:45",
      "endTime": "11:15",
      "startTimeConversational": "10:45 AM",
      "endTimeConversational": "11:15 AM"
    },
    {
      "start": "2025-09-17T10:00:00.000Z",
      "end": "2025-09-17T10:30:00.000Z",
      "startTime": "11:00",
      "endTime": "11:30",
      "startTimeConversational": "11:00 AM",
      "endTimeConversational": "11:30 AM"
    },
    {
      "start": "2025-09-17T10:15:00.000Z",
      "end": "2025-09-17T10:45:00.000Z",
      "startTime": "11:15",
      "endTime": "11:45",
      "startTimeConversational": "11:15 AM",
      "endTimeConversational": "11:45 AM"
    },
    {
      "start": "2025-09-17T10:30:00.000Z",
      "end": "2025-09-17T11:00:00.000Z",
      "startTime": "11:30",
      "endTime": "12:00",
      "startTimeConversational": "11:30 AM",
      "endTimeConversational": "12:00 PM"
    },
    {
      "start": "2025-09-17T10:45:00.000Z",
      "end": "2025-09-17T11:15:00.000Z",
      "startTime": "11:45",
      "endTime": "12:15",
      "startTimeConversational": "11:45 AM",
      "endTimeConversational": "12:15 PM"
    },
    {
      "start": "2025-09-17T11:00:00.000Z",
      "end": "2025-09-17T11:30:00.000Z",
      "startTime": "12:00",
      "endTime": "12:30",
      "startTimeConversational": "12:00 PM",
      "endTimeConversational": "12:30 PM"
    },
    {
      "start": "2025-09-17T11:15:00.000Z",
      "end": "2025-09-17T11:45:00.000Z",
      "startTime": "12:15",
      "endTime": "12:45",
      "startTimeConversational": "12:15 PM",
      "endTimeConversational": "12:45 PM"
    },
    {
      "start": "2025-09-17T12:00:00.000Z",
      "end": "2025-09-17T12:30:00.000Z",
      "startTime": "13:00",
      "endTime": "13:30",
      "startTimeConversational": "1:00 PM",
      "endTimeConversational": "1:30 PM"
    },
    {
      "start": "2025-09-17T12:15:00.000Z",
      "end": "2025-09-17T12:45:00.000Z",
      "startTime": "13:15",
      "endTime": "13:45",
      "startTimeConversational": "1:15 PM",
      "endTimeConversational": "1:45 PM"
    },
    {
      "start": "2025-09-17T12:30:00.000Z",
      "end": "2025-09-17T13:00:00.000Z",
      "startTime": "13:30",
      "endTime": "14:00",
      "startTimeConversational": "1:30 PM",
      "endTimeConversational": "2:00 PM"
    },
    {
      "start": "2025-09-17T14:30:00.000Z",
      "end": "2025-09-17T15:00:00.000Z",
      "startTime": "15:30",
      "endTime": "16:00",
      "startTimeConversational": "3:30 PM",
      "endTimeConversational": "4:00 PM"
    },
    {
      "start": "2025-09-17T14:45:00.000Z",
      "end": "2025-09-17T15:15:00.000Z",
      "startTime": "15:45",
      "endTime": "16:15",
      "startTimeConversational": "3:45 PM",
      "endTimeConversational": "4:15 PM"
    }
  ],
  "date": "2025-09-17",
  "businessId": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "serviceId": "4395775e-fa81-4a69-8425-e46c3853dea4"
}
[2025-09-16T11:04:29.919Z] üìä Response type: object
[2025-09-16T11:04:29.919Z] üìä Has slots: true
[2025-09-16T11:04:29.919Z] üìä Slots count: 19
‚úÖ Available time slots: [
  '09:00', '09:15', '09:30',
  '09:45', '10:00', '10:15',
  '10:30', '10:45', '11:00',
  '11:15', '11:30', '11:45',
  '12:00', '12:15', '13:00',
  '13:15', '13:30', '15:30',
  '15:45'
]
üìù Session updated for call CA00d6818c2d333242403066de235d7e6b: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z'
}
üìÖ Stored checked date in session: 2025-09-17
‚úÖ Sending get_available_slots response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_z8C02Z13QCd85m7DqpHNs3q2","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-17\"}","response":"{\"available_slots\":[\"09...
Message string: {"type":"History","function_calls":[{"id":"call_z8C02Z13QCd85m7DqpHNs3q2","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-17\"}","response":"{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"11:45\",\"12:00\",\"12:15\",\"13:00\",\"13:15\",\"13:30\",\"15:30\",\"15:45\"]}"}]}
[2025-09-16T11:04:33.179Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_z8C02Z13QCd85m7DqpHNs3q2","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-17\"}","response":"{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"11:45\",\"12:00\",\"12:15\",\"13:00\",\"13:15\",\"13:30\",\"15:30\",\"15:45\"]}"}]}
[2025-09-16T11:04:33.179Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_z8C02Z13QCd85m7DqpHNs3q2",
      "name": "get_available_slots",
      "client_side": true,
      "arguments": "{\"date\":\"2025-09-17\"}",
      "response": "{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"11:45\",\"12:00\",\"12:15\",\"13:00\",\"13:15\",\"13:30\",\"15:30\",\"15:45\"]}"
    }
  ]
}
[2025-09-16T11:04:33.179Z] === END PARSED JSON ===
[2025-09-16T11:04:33.179Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:33.179Z] üìú HISTORY: Message logged
[2025-09-16T11:04:32.912Z] üîá Audio stream ended (timeout)
[2025-09-16T11:04:29.918Z] ‚úÖ COMPLETED: handleFunctionCall for get_available_slots
[2025-09-16T11:04:34.029Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-16T11:04:29.918Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
[2025-09-16T11:04:36.381Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}...
Message string: {"type":"ConversationText","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}
[2025-09-16T11:04:36.839Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}
[2025-09-16T11:04:36.839Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."
}
[2025-09-16T11:04:36.839Z] === END PARSED JSON ===
[2025-09-16T11:04:36.839Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:36.839Z] üí≠ CONVERSATION_TEXT: 3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open.
[2025-09-16T11:04:36.839Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: 3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}...
Message string: {"type":"History","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}
[2025-09-16T11:04:36.859Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."}
[2025-09-16T11:04:36.859Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open."
}
[2025-09-16T11:04:36.859Z] === END PARSED JSON ===
[2025-09-16T11:04:36.859Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:36.859Z] üìú HISTORY: Message logged
[2025-09-16T11:04:36.859Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: 3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open.
[2025-09-16T11:04:36.859Z] üìù Added transcript: [AI] 3 PM on Wednesday, the 17th is not available, but I do have 3:30 PM or 3:45 PM open.
[2025-09-16T11:04:36.859Z] üéµ Starting audio stream - feeding buffer
[2025-09-16T11:04:37.028Z] üîá Audio stream ended (timeout)
[2025-09-16T11:04:40.381Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Would either of those times work for you instead?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Would either of those times work for you instead?"}
[2025-09-16T11:04:43.920Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Would either of those times work for you instead?"}
[2025-09-16T11:04:43.920Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Would either of those times work for you instead?"
}
[2025-09-16T11:04:43.920Z] === END PARSED JSON ===
[2025-09-16T11:04:43.920Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:43.920Z] üí≠ CONVERSATION_TEXT: Would either of those times work for you instead?
[2025-09-16T11:04:43.920Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Would either of those times work for you instead?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Would either of those times work for you instead?"}...
Message string: {"type":"History","role":"assistant","content":"Would either of those times work for you instead?"}
[2025-09-16T11:04:43.927Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Would either of those times work for you instead?"}
[2025-09-16T11:04:43.927Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Would either of those times work for you instead?"
}
[2025-09-16T11:04:43.927Z] === END PARSED JSON ===
[2025-09-16T11:04:43.927Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:43.927Z] üìú HISTORY: Message logged
[2025-09-16T11:04:43.927Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Would either of those times work for you instead?
[2025-09-16T11:04:43.927Z] üìù Added transcript: [AI] Would either of those times work for you instead?
[2025-09-16T11:04:43.928Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-16T11:04:43.944Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-16T11:04:43.944Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-16T11:04:43.944Z] === END PARSED JSON ===
[2025-09-16T11:04:43.944Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-16T11:04:43.944Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-16T11:04:43.944Z] üîá SILENCE: Started tracking
[2025-09-16T11:04:43.944Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-16T11:04:44.381Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:04:43.944Z] üîá SILENCE_CHECK: 1000ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-16T11:04:45.395Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-16T11:04:45.395Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-16T11:04:45.395Z] === END PARSED JSON ===
[2025-09-16T11:04:45.395Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-16T11:04:45.395Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-16T11:04:45.395Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-16T11:04:45.395Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}...
Message string: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.137Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.137Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Yes. Let's go with three thirty then."
}
[2025-09-16T11:04:48.137Z] === END PARSED JSON ===
[2025-09-16T11:04:48.137Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:48.137Z] üí≠ CONVERSATION_TEXT: Yes. Let's go with three thirty then.
[2025-09-16T11:04:48.137Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Yes. Let's go with three tON ===
{
  "type": "AgentAudioDone"
}
[2025-09-16T11:04:43.944Z] === END PARSED JSON ===
[2025-09-16T11:04:43.944Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-16T11:04:43.944Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-16T11:04:43.944Z] üîá SILENCE: Started tracking
[2025-09-16T11:04:43.944Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-16T11:04:44.381Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:04:43.944Z] üîá SILENCE_CHECK: 1000ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-16T11:04:45.395Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-16T11:04:45.395Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-16T11:04:45.395Z] === END PARSED JSON ===
[2025-09-16T11:04:45.395Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-16T11:04:45.395Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-16T11:04:45.395Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-16T11:04:45.395Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}...
Message string: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.137Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.137Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Yes. Let's go with three thirty then."
}
[2025-09-16T11:04:48.137Z] === END PARSED JSON ===
[2025-09-16T11:04:48.137Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:48.137Z] üí≠ CONVERSATION_TEXT: Yes. Let's go with three thirty then.
[2025-09-16T11:04:48.137Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Yes. Let's go with three thirty then.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Yes. Let's go with three thirty then."}...
Message string: {"type":"History","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.144Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Yes. Let's go with three thirty then."}
[2025-09-16T11:04:48.144Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Yes. Let's go with three thirty then."
}
[2025-09-16T11:04:48.144Z] === END PARSED JSON ===
[2025-09-16T11:04:48.144Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:48.144Z] üìú HISTORY: Message logged
[2025-09-16T11:04:48.144Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Yes. Let's go with three thirty then.
[2025-09-16T11:04:48.144Z] üìù Added transcript: [User] Yes. Let's go with three thirty then.
[2025-09-16T11:04:48.382Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","arguments":"{\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","arguments":"{\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","client_side":true}]}
[2025-09-16T11:04:49.579Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","arguments":"{\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","client_side":true}]}
[2025-09-16T11:04:49.579Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_OwifBVlzg3yyS4jmSvB0RXmX",
      "name": "update_booking",
      "arguments": "{\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",
      "client_side": true
    }
  ]
}
[2025-09-16T11:04:49.579Z] === END PARSED JSON ===
[2025-09-16T11:04:49.579Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-16T11:04:49.579Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-16T11:04:49.579Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-16T11:04:49.579Z] üìã Functions: [
  {
    "id": "call_OwifBVlzg3yyS4jmSvB0RXmX",
    "name": "update_booking",
    "arguments": "{\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",
    "client_side": true
  }
]
[2025-09-16T11:04:49.579Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-16T11:04:49.579Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-16T11:04:49.579Z] üîß Processing function: update_booking
[2025-09-16T11:04:49.579Z] üîß CALLING: handleFunctionCall for update_booking...
üìù Session updated for call CA00d6818c2d333242403066de235d7e6b: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z'
}
[2025-09-16T11:04:49.579Z] üöÄ STARTING handleFunctionCall
[2025-09-16T11:04:49.579Z] üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_OwifBVlzg3yyS4jmSvB0RXmX",
  "parameters": {
    "customer_name": "Marco",
    "new_date": "2025-09-17",
    "new_time": "15:30"
  }
}
[2025-09-16T11:04:49.579Z] üìã Function name: update_booking
[2025-09-16T11:04:49.579Z] üìä Parameters: {
  "customer_name": "Marco",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
[2025-09-16T11:04:49.579Z] üè¢ Business config exists: true
[2025-09-16T11:04:49.579Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_OwifBVlzg3yyS4jmSvB0RXmX",
  "parameters": {
    "customer_name": "Marco",
    "new_date": "2025-09-17",
    "new_time": "15:30"
  }
}
üìù updateBooking called with params: {
  "customer_name": "Marco",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
üìã Session data: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z'
}
‚ö†Ô∏è Using fallback session data - this may update the wrong appointment
üîÑ Using customer info: {
  customerName: 'Marco',
  currentDate: undefined,
  currentTime: undefined
}
üìû Caller phone: +447468306825
üë§ Customer: Marco
üìÖ Booking: undefined at undefined
üìù Session updated for call CA00d6818c2d333242403066de235d7e6b: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z',
  bookings: [
    {
      customerName: 'Marco',
      currentDate: undefined,
      currentTime: undefined,
      newDate: '2025-09-17',
      newTime: '15:30',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastBookingDate: '2025-09-17',
  lastBookingTime: '15:30'
}
üì¶ Update request body: {
  "business_id": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "customer_name": "Marco",
  "caller_phone": "+447468306825",
  "sessionId": "CA00d6818c2d333242403066de235d7e6b",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
‚ùå Update booking API error: 400 {"error":"Missing required parameters: business_id, customer_name, current_date, current_time"}
‚úÖ Sending update_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\",\"customer_name\":...
Message string: {"type":"History","function_calls":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\",\"customer_name\":\"Marco\"}","response":"{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"Missing required parameters: business_id, customer_name, current_date, current_time\\\"}\"}"}]}
[2025-09-16T11:04:50.259Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_OwifBVlzg3yyS4jmSvB0RXmX","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\",\"customer_name\":\"Marco\"}","response":"{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"Missing required parameters: business_id, customer_name, current_date, current_time\\\"}\"}"}]}
[2025-09-16T11:04:50.259Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_OwifBVlzg3yyS4jmSvB0RXmX",
      "name": "update_booking",
      "client_side": true,
      "arguments": "{\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\",\"customer_name\":\"Marco\"}",
      "response": "{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"Missing required parameters: business_id, customer_name, current_date, current_time\\\"}\"}"
    }
  ]
}
[2025-09-16T11:04:50.259Z] === END PARSED JSON ===
[2025-09-16T11:04:50.259Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:50.259Z] üìú HISTORY: Message logged
[2025-09-16T11:04:49.579Z] ‚úÖ COMPLETED: handleFunctionCall for update_booking
[2025-09-16T11:04:51.110Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-16T11:04:49.579Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}...
Message string: {"type":"ConversationText","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}
[2025-09-16T11:04:51.166Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}
[2025-09-16T11:04:51.166Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "It seems I need to confirm a couple more details before updating your booking."
}
[2025-09-16T11:04:51.166Z] === END PARSED JSON ===
[2025-09-16T11:04:51.166Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:51.166Z] üí≠ CONVERSATION_TEXT: It seems I need to confirm a couple more details before updating your booking.
[2025-09-16T11:04:51.166Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: It seems I need to confirm a couple more details before updating your booking.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}...
Message string: {"type":"History","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}
[2025-09-16T11:04:51.169Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"It seems I need to confirm a couple more details before updating your booking."}
[2025-09-16T11:04:51.169Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "It seems I need to confirm a couple more details before updating your booking."
}
[2025-09-16T11:04:51.169Z] === END PARSED JSON ===
[2025-09-16T11:04:51.169Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:51.169Z] üìú HISTORY: Message logged
[2025-09-16T11:04:51.169Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: It seems I need to confirm a couple more details before updating your booking.
[2025-09-16T11:04:51.169Z] üìù Added transcript: [AI] It seems I need to confirm a couple more details before updating your booking.
[2025-09-16T11:04:51.170Z] üéµ Starting audio stream - feeding buffer
[2025-09-16T11:04:52.382Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:04:52.789Z] üîá Audio stream ended (timeout)
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Could you please confirm the current appointment time once more?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Could you please confirm the current appointment time once more?"}
[2025-09-16T11:04:55.367Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Could you please confirm the current appointment time once more?"}
[2025-09-16T11:04:55.367Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Could you please confirm the current appointment time once more?"
}
[2025-09-16T11:04:55.367Z] === END PARSED JSON ===
[2025-09-16T11:04:55.367Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:55.367Z] üí≠ CONVERSATION_TEXT: Could you please confirm the current appointment time once more?
[2025-09-16T11:04:55.367Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Could you please confirm the current appointment time once more?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Could you please confirm the current appointment time once more?"}...
Message string: {"type":"History","role":"assistant","content":"Could you please confirm the current appointment time once more?"}
[2025-09-16T11:04:55.368Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Could you please confirm the current appointment time once more?"}
[2025-09-16T11:04:55.368Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Could you please confirm the current appointment time once more?"
}
[2025-09-16T11:04:55.368Z] === END PARSED JSON ===
[2025-09-16T11:04:55.368Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:55.368Z] üìú HISTORY: Message logged
[2025-09-16T11:04:55.368Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Could you please confirm the current appointment time once more?
[2025-09-16T11:04:55.368Z] üìù Added transcript: [AI] Could you please confirm the current appointment time once more?
[2025-09-16T11:04:55.368Z] üéµ Starting audio stream - feeding buffer
[2025-09-16T11:04:55.400Z] üîá Audio stream ended (timeout)
[2025-09-16T11:04:56.382Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}
[2025-09-16T11:04:58.849Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}
[2025-09-16T11:04:58.849Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"
}
[2025-09-16T11:04:58.849Z] === END PARSED JSON ===
[2025-09-16T11:04:58.849Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:04:58.849Z] üí≠ CONVERSATION_TEXT: You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?
[2025-09-16T11:04:58.849Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}...
Message string: {"type":"History","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}
[2025-09-16T11:04:58.850Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"}
[2025-09-16T11:04:58.850Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?"
}
[2025-09-16T11:04:58.850Z] === END PARSED JSON ===
[2025-09-16T11:04:58.850Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:04:58.850Z] üìú HISTORY: Message logged
[2025-09-16T11:04:58.850Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?
[2025-09-16T11:04:58.850Z] üìù Added transcript: [AI] You mentioned 10:30 AM on Thursday, the 18th‚Äîis that correct?
[2025-09-16T11:04:58.850Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-16T11:04:58.890Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-16T11:04:58.890Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-16T11:04:58.890Z] === END PARSED JSON ===
[2025-09-16T11:04:58.890Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-16T11:04:58.890Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-16T11:04:58.890Z] üîá SILENCE: Started tracking
[2025-09-16T11:04:58.890Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 1000ms of silence
[2025-09-16T11:05:00.382Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 2001ms of silence
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 3001ms of silence
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 4001ms of silence
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 5001ms of silence
[2025-09-16T11:05:04.382Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:04:58.890Z] üîá SILENCE_CHECK: 6001ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-16T11:05:05.073Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-16T11:05:05.073Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-16T11:05:05.073Z] === END PARSED JSON ===
[2025-09-16T11:05:05.073Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-16T11:05:05.073Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-16T11:05:05.073Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-16T11:05:05.073Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Yes."}...
Message string: {"type":"ConversationText","role":"user","content":"Yes."}
[2025-09-16T11:05:05.098Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Yes."}
[2025-09-16T11:05:05.098Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Yes."
}
[2025-09-16T11:05:05.098Z] === END PARSED JSON ===
[2025-09-16T11:05:05.098Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:05:05.098Z] üí≠ CONVERSATION_TEXT: Yes.
[2025-09-16T11:05:05.098Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Yes.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Yes."}...
Message string: {"type":"History","role":"user","content":"Yes."}
[2025-09-16T11:05:05.104Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Yes."}
[2025-09-16T11:05:05.104Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Yes."
}
[2025-09-16T11:05:05.104Z] === END PARSED JSON ===
[2025-09-16T11:05:05.104Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:05:05.104Z] üìú HISTORY: Message logged
[2025-09-16T11:05:05.104Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Yes.
[2025-09-16T11:05:05.104Z] üìù Added transcript: [User] Yes.
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Ma...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","client_side":true}]}
[2025-09-16T11:05:06.614Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","client_side":true}]}
[2025-09-16T11:05:06.614Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_2Zjc6TRWQWNoFw3QaibQMabT",
      "name": "update_booking",
      "arguments": "{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",
      "client_side": true
    }
  ]
}
[2025-09-16T11:05:06.614Z] === END PARSED JSON ===
[2025-09-16T11:05:06.614Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-16T11:05:06.614Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-16T11:05:06.614Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-16T11:05:06.614Z] üìã Functions: [
  {
    "id": "call_2Zjc6TRWQWNoFw3QaibQMabT",
    "name": "update_booking",
    "arguments": "{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",
    "client_side": true
  }
]
[2025-09-16T11:05:06.614Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-16T11:05:06.615Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-16T11:05:06.614Z] üîß Processing function: update_booking
[2025-09-16T11:05:06.614Z] üîß CALLING: handleFunctionCall for update_booking...
üìù Session updated for call CA00d6818c2d333242403066de235d7e6b: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z',
  bookings: [
    {
      customerName: 'Marco',
      currentDate: undefined,
      currentTime: undefined,
      newDate: '2025-09-17',
      newTime: '15:30',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastBookingDate: '2025-09-17',
  lastBookingTime: '15:30'
}
[2025-09-16T11:05:06.615Z] üöÄ STARTING handleFunctionCall
[2025-09-16T11:05:06.615Z] üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_2Zjc6TRWQWNoFw3QaibQMabT",
  "parameters": {
    "current_date": "2025-09-18",
    "current_time": "10:30",
    "customer_name": "Marco",
    "new_date": "2025-09-17",
    "new_time": "15:30"
  }
}
[2025-09-16T11:05:06.615Z] üìã Function name: update_booking
[2025-09-16T11:05:06.615Z] üìä Parameters: {
  "current_date": "2025-09-18",
  "current_time": "10:30",
  "customer_name": "Marco",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
[2025-09-16T11:05:06.615Z] üè¢ Business config exists: true
[2025-09-16T11:05:06.615Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_2Zjc6TRWQWNoFw3QaibQMabT",
  "parameters": {
    "current_date": "2025-09-18",
    "current_time": "10:30",
    "customer_name": "Marco",
    "new_date": "2025-09-17",
    "new_time": "15:30"
  }
}
üìù updateBooking called with params: {
  "current_date": "2025-09-18",
  "current_time": "10:30",
  "customer_name": "Marco",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
üìã Session data: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z',
  bookings: [
    {
      customerName: 'Marco',
      currentDate: undefined,
      currentTime: undefined,
      newDate: '2025-09-17',
      newTime: '15:30',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastBookingDate: '2025-09-17',
  lastBookingTime: '15:30'
}
üîÑ Using customer info: {
  customerName: 'Marco',
  currentDate: '2025-09-18',
  currentTime: '10:30'
}
üìû Caller phone: +447468306825
üë§ Customer: Marco
üìÖ Booking: 2025-09-18 at 10:30
üìù Session updated for call CA00d6818c2d333242403066de235d7e6b: {
  callerPhone: '+447468306825',
  lastCheckedDate: '2025-09-17',
  lastCheckedTimestamp: '2025-09-16T11:04:33.029Z',
  bookings: [
    {
      customerName: 'Marco',
      currentDate: undefined,
      currentTime: undefined,
      newDate: '2025-09-17',
      newTime: '15:30',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '10:30',
      newDate: '2025-09-17',
      newTime: '15:30',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastBookingDate: '2025-09-17',
  lastBookingTime: '15:30'
}
üì¶ Update request body: {
  "business_id": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "customer_name": "Marco",
  "current_date": "2025-09-18",
  "current_time": "10:30",
  "caller_phone": "+447468306825",
  "sessionId": "CA00d6818c2d333242403066de235d7e6b",
  "new_date": "2025-09-17",
  "new_time": "15:30"
}
‚ùå Update booking API error: 409 {"error":"The new time slot 2025-09-17 at 15:30 is not available"}
‚úÖ Sending update_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","client_side":true,"arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer...
Message string: {"type":"History","function_calls":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","client_side":true,"arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","response":"{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"The new time slot 2025-09-17 at 15:30 is not available\\\"}\"}"}]}
[2025-09-16T11:05:09.207Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_2Zjc6TRWQWNoFw3QaibQMabT","name":"update_booking","client_side":true,"arguments":"{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}","response":"{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"The new time slot 2025-09-17 at 15:30 is not available\\\"}\"}"}]}
[2025-09-16T11:05:09.207Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_2Zjc6TRWQWNoFw3QaibQMabT",
      "name": "update_booking",
      "client_side": true,
      "arguments": "{\"current_date\":\"2025-09-18\",\"current_time\":\"10:30\",\"customer_name\":\"Marco\",\"new_date\":\"2025-09-17\",\"new_time\":\"15:30\"}",
      "response": "{\"error\":\"Failed to update booking: {\\\"error\\\":\\\"The new time slot 2025-09-17 at 15:30 is not available\\\"}\"}"
    }
  ]
}
[2025-09-16T11:05:09.207Z] === END PARSED JSON ===
[2025-09-16T11:05:09.207Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:05:09.207Z] üìú HISTORY: Message logged
[2025-09-16T11:05:06.614Z] ‚úÖ COMPLETED: handleFunctionCall for update_booking
[2025-09-16T11:05:10.063Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-16T11:05:06.614Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}...
Message string: {"type":"ConversationText","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}
[2025-09-16T11:05:10.398Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}
[2025-09-16T11:05:10.398Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."
}
[2025-09-16T11:05:10.398Z] === END PARSED JSON ===
[2025-09-16T11:05:10.398Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:05:10.398Z] üí≠ CONVERSATION_TEXT: I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available.
[2025-09-16T11:05:10.398Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}...
Message string: {"type":"History","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}
[2025-09-16T11:05:10.398Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."}
[2025-09-16T11:05:10.398Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available."
}
[2025-09-16T11:05:10.398Z] === END PARSED JSON ===
[2025-09-16T11:05:10.398Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-16T11:05:10.398Z] üìú HISTORY: Message logged
[2025-09-16T11:05:10.398Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available.
[2025-09-16T11:05:10.398Z] üìù Added transcript: [AI] I tried to update your appointment to 3:30 PM on Wednesday, the 17th, but that slot is actually not available.
[2025-09-16T11:05:10.398Z] üéµ Starting audio stream - feeding buffer
[2025-09-16T11:05:12.382Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-16T11:05:13.564Z] üîá Audio stream ended (timeout)
[2025-09-16T11:05:16.382Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}...
Message string: {"type":"ConversationText","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}
[2025-09-16T11:05:17.999Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}
[2025-09-16T11:05:17.999Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."
}
[2025-09-16T11:05:17.999Z] === END PARSED JSON ===
[2025-09-16T11:05:17.999Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-16T11:05:17.999Z] üí≠ CONVERSATION_TEXT: The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken.
[2025-09-16T11:05:17.999Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}...
Message string: {"type":"History","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}
[2025-09-16T11:05:18.006Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."}
[2025-09-16T11:05:18.006Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "The options I have for that day are 3:30 PM and 3:45 PM, but it seems 3:30 PM just got taken."
}
[2025-09-16T11:05:18.006Z] === END PARSED JSON ===
[2025-09-16T11:05:18.006Z] üéØ DEEPGRAM EVENT TYPE: History