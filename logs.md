25-08-31T10:15:29.908Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:29.908Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:29.911Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:29.911Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:29.911Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:29.911Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:29.912Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:29.912Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:29.912Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:29.912Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:29.937Z] 🔊 INIT: Received binary audio from Deepgram (320 bytes)
[2025-08-31T10:15:29.938Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:29.938Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:29.938Z] 🔍 MESSAGE LENGTH: 320
Processing binary audio data from Deepgram (320 bytes)
[2025-08-31T10:15:29.956Z] 📨 INIT: Deepgram message: AgentAudioDone
[2025-08-31T10:15:29.956Z] 📦 INIT: Full data: {
  "type": "AgentAudioDone"
}
[2025-08-31T10:15:29.956Z] 📨 OTHER: Initialization message type: AgentAudioDone
[2025-08-31T10:15:29.956Z] 📦 OTHER: Full data: {
  "type": "AgentAudioDone"
}
[2025-08-31T10:15:29.956Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:29.956Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:29.956Z] 🔍 MESSAGE LENGTH: 25
Processing binary audio data from Deepgram (25 bytes)
[2025-08-31T10:15:30.737Z] 💓 KEEPALIVE: Sent to Deepgram
[2025-08-31T10:15:33.594Z] 📨 INIT: Deepgram message: UserStartedSpeaking
[2025-08-31T10:15:33.594Z] 📦 INIT: Full data: {
  "type": "UserStartedSpeaking"
}
[2025-08-31T10:15:33.594Z] 📨 OTHER: Initialization message type: UserStartedSpeaking
[2025-08-31T10:15:33.594Z] 📦 OTHER: Full data: {
  "type": "UserStartedSpeaking"
}
[2025-08-31T10:15:33.594Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:33.594Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:33.594Z] 🔍 MESSAGE LENGTH: 30
Processing binary audio data from Deepgram (30 bytes)
[2025-08-31T10:15:34.488Z] 📨 INIT: Deepgram message: ConversationText
[2025-08-31T10:15:34.488Z] 📦 INIT: Full data: {
  "type": "ConversationText",
  "role": "user",
  "content": "I want to book a haircut."
}
[2025-08-31T10:15:34.488Z] 📨 OTHER: Initialization message type: ConversationText
[2025-08-31T10:15:34.488Z] 📦 OTHER: Full data: {
  "type": "ConversationText",
  "role": "user",
  "content": "I want to book a haircut."
}
[2025-08-31T10:15:34.489Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:34.489Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:34.489Z] 🔍 MESSAGE LENGTH: 79
Processing binary audio data from Deepgram (79 bytes)
[2025-08-31T10:15:34.497Z] 📨 INIT: Deepgram message: History
[2025-08-31T10:15:34.497Z] 📦 INIT: Full data: {
  "type": "History",
  "role": "user",
  "content": "I want to book a haircut."
}
[2025-08-31T10:15:34.497Z] 📨 OTHER: Initialization message type: History
[2025-08-31T10:15:34.497Z] 📦 OTHER: Full data: {
  "type": "History",
  "role": "user",
  "content": "I want to book a haircut."
}
[2025-08-31T10:15:34.497Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:34.497Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:34.497Z] 🔍 MESSAGE LENGTH: 70
Processing binary audio data from Deepgram (70 bytes)
[2025-08-31T10:15:35.731Z] 📨 INIT: Deepgram message: ConversationText
[2025-08-31T10:15:35.731Z] 📦 INIT: Full data: {
  "type": "ConversationText",
  "role": "assistant",
  "content": "Great choice, Smith!"
}
[2025-08-31T10:15:35.731Z] 📨 OTHER: Initialization message type: ConversationText
[2025-08-31T10:15:35.731Z] 📦 OTHER: Full data: {
  "type": "ConversationText",
  "role": "assistant",
  "content": "Great choice, Smith!"
}
[2025-08-31T10:15:35.731Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.731Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.731Z] 🔍 MESSAGE LENGTH: 79
Processing binary audio data from Deepgram (79 bytes)
[2025-08-31T10:15:35.737Z] 💓 KEEPALIVE: Sent to Deepgram
[2025-08-31T10:15:35.742Z] 📨 INIT: Deepgram message: History
[2025-08-31T10:15:35.742Z] 📦 INIT: Full data: {
  "type": "History",
  "role": "assistant",
  "content": "Great choice, Smith!"
}
[2025-08-31T10:15:35.742Z] 📨 OTHER: Initialization message type: History
[2025-08-31T10:15:35.742Z] 📦 OTHER: Full data: {
  "type": "History",
  "role": "assistant",
  "content": "Great choice, Smith!"
}
[2025-08-31T10:15:35.742Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.742Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.742Z] 🔍 MESSAGE LENGTH: 70
Processing binary audio data from Deepgram (70 bytes)
[2025-08-31T10:15:35.742Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.742Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.742Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.742Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.742Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.742Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.742Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.742Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.742Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.742Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.742Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.742Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.955Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.955Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.955Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.955Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.955Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.955Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.955Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.955Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.959Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.960Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.960Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.960Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:35.960Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:35.960Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:35.960Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:35.960Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.183Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:36.183Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.183Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.183Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.183Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:36.183Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.183Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.183Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.187Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:36.188Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.188Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.188Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.188Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:36.188Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.188Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.188Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.196Z] 📨 INIT: Deepgram message: FunctionCallRequest
[2025-08-31T10:15:36.196Z] 📦 INIT: Full data: {
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_AbkbMuVvkqyBboyklkIE1do1",
      "name": "get_available_slots",
      "arguments": "{\"date\":\"2025-09-01\",\"service_id\":\"haircut\"}",
      "client_side": true
    }
  ]
}
[2025-08-31T10:15:36.196Z] 🚨🚨 FUNCTION_CALL_REQUEST in INIT! 🚨🚨
[2025-08-31T10:15:36.196Z] ✅ SUCCESS: AI requesting function calls!
[2025-08-31T10:15:36.196Z] 📋 Functions: [
  {
    "id": "call_AbkbMuVvkqyBboyklkIE1do1",
    "name": "get_available_slots",
    "arguments": "{\"date\":\"2025-09-01\",\"service_id\":\"haircut\"}",
    "client_side": true
  }
]
[2025-08-31T10:15:36.196Z] 🔧 Processing function: get_available_slots
[2025-08-31T10:15:36.196Z] 🔧 CALLING: handleFunctionCall for get_available_slots...
[2025-08-31T10:15:36.197Z] 🚀 STARTING handleFunctionCall
[2025-08-31T10:15:36.197Z] 🔧 Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_AbkbMuVvkqyBboyklkIE1do1",
  "parameters": {
    "date": "2025-09-01",
    "service_id": "haircut"
  }
}
[2025-08-31T10:15:36.197Z] 📋 Function name: get_available_slots
[2025-08-31T10:15:36.197Z] 📊 Parameters: {
  "date": "2025-09-01",
  "service_id": "haircut"
}
[2025-08-31T10:15:36.197Z] 🏢 Business config exists: true
[2025-08-31T10:15:36.197Z] 🌐 WebSocket state: 1
🔧 Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_AbkbMuVvkqyBboyklkIE1do1",
  "parameters": {
    "date": "2025-09-01",
    "service_id": "haircut"
  }
}
[2025-08-31T10:15:36.197Z] 🚀 STARTING getAvailableSlots with params: {
  "date": "2025-09-01",
  "service_id": "haircut"
}
[2025-08-31T10:15:36.197Z] 🏢 Business config: barber
[2025-08-31T10:15:36.197Z] 📋 Services count: 1
[2025-08-31T10:15:36.197Z] 🌐 Site URL: https://vocalenda.vercel.app
[2025-08-31T10:15:36.197Z] 🔑 Secret exists: true
🗓️ Getting available slots for: {
  "date": "2025-09-01",
  "service_id": "haircut"
}
❌ Service not found with ID: haircut
[2025-08-31T10:15:36.197Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.197Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.197Z] 🔍 MESSAGE LENGTH: 198
Processing binary audio data from Deepgram (198 bytes)
✅ Sending get_available_slots response to Deepgram
✅ Function response sent successfully to Deepgram
🔄 Waiting for Deepgram to process the response...
[2025-08-31T10:15:36.196Z] ✅ COMPLETED: handleFunctionCall for get_available_slots
[2025-08-31T10:15:36.295Z] 🔊 INIT: Received binary audio from Deepgram (960 bytes)
[2025-08-31T10:15:36.295Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.295Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.295Z] 🔍 MESSAGE LENGTH: 960
Processing binary audio data from Deepgram (960 bytes)
[2025-08-31T10:15:36.297Z] 🔊 INIT: Received binary audio from Deepgram (640 bytes)
[2025-08-31T10:15:36.297Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.297Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.297Z] 🔍 MESSAGE LENGTH: 640
Processing binary audio data from Deepgram (640 bytes)
[2025-08-31T10:15:36.347Z] 📨 INIT: Deepgram message: Error
[2025-08-31T10:15:36.347Z] 📦 INIT: Full data: {
  "type": "Error",
  "description": "Text message received from client did not match any of the formats we expect.",
  "code": "UNPARSABLE_CLIENT_MESSAGE"
}
[2025-08-31T10:15:36.347Z] 📨 OTHER: Initialization message type: Error
[2025-08-31T10:15:36.347Z] 📦 OTHER: Full data: {
  "type": "Error",
  "description": "Text message received from client did not match any of the formats we expect.",
  "code": "UNPARSABLE_CLIENT_MESSAGE"
}
[2025-08-31T10:15:36.347Z] 🔍 RAW MESSAGE TYPE: object
[2025-08-31T10:15:36.347Z] 🔍 IS BUFFER: true
[2025-08-31T10:15:36.347Z] 🔍 MESSAGE LENGTH: 145
Processing binary audio data from Deepgram (145 bytes)
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
Deepgram WebSocket closed in initializeDeepgram. Code: 1005, Reason: 
Deepgram WebSocket closed. Code: 1005, Reason: 
🚨 Unexpected Deepgram close - this may cause issues
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true
⚠️ Cannot forward audio - deepgramWs ready: false, isReady: true