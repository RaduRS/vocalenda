📨 Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}...
Message string: {"type":"ConversationText","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}
[2025-09-07T08:41:09.531Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}
[2025-09-07T08:41:09.531Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "It seems I couldn't retrieve the available slots for that day at the moment."
}
[2025-09-07T08:41:09.531Z] === END PARSED JSON ===
[2025-09-07T08:41:09.531Z] 🎯 DEEPGRAM EVENT TYPE: ConversationText
[2025-09-07T08:41:09.531Z] 💭 CONVERSATION_TEXT: It seems I couldn't retrieve the available slots for that day at the moment.
📨 Received Deepgram JSON message: {"type":"History","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}...
Message string: {"type":"History","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}
[2025-09-07T08:41:09.531Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"It seems I couldn't retrieve the available slots for that day at the moment."}
[2025-09-07T08:41:09.531Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "It seems I couldn't retrieve the available slots for that day at the moment."
}
[2025-09-07T08:41:09.531Z] === END PARSED JSON ===
[2025-09-07T08:41:09.531Z] 🎯 DEEPGRAM EVENT TYPE: History
[2025-09-07T08:41:09.531Z] ❓ UNKNOWN_EVENT_TYPE: History
[2025-09-07T08:41:09.531Z] 📦 Full message: {
  "type": "History",
  "role": "assistant",
  "content": "It seems I couldn't retrieve the available slots for that day at the moment."
}
[2025-09-07T08:41:09.531Z] 🎵 Starting audio stream - feeding buffer
[2025-09-07T08:41:10.876Z] 🔇 Audio stream ended (timeout)
📨 Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}
[2025-09-07T08:41:13.053Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}
[2025-09-07T08:41:13.053Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Would you like to try a different time or another day for your beard trim?"
}
[2025-09-07T08:41:13.053Z] === END PARSED JSON ===
[2025-09-07T08:41:13.053Z] 🎯 DEEPGRAM EVENT TYPE: ConversationText
[2025-09-07T08:41:13.053Z] 💭 CONVERSATION_TEXT: Would you like to try a different time or another day for your beard trim?
📨 Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}...
Message string: {"type":"History","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}
[2025-09-07T08:41:13.053Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Would you like to try a different time or another day for your beard trim?"}
[2025-09-07T08:41:13.053Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Would you like to try a different time or another day for your beard trim?"
}
[2025-09-07T08:41:13.053Z] === END PARSED JSON ===
[2025-09-07T08:41:13.053Z] 🎯 DEEPGRAM EVENT TYPE: History
[2025-09-07T08:41:13.053Z] ❓ UNKNOWN_EVENT_TYPE: History
[2025-09-07T08:41:13.053Z] 📦 Full message: {
  "type": "History",
  "role": "assistant",
  "content": "Would you like to try a different time or another day for your beard trim?"
}
[2025-09-07T08:41:13.053Z] 🎵 Starting audio stream - feeding buffer
[2025-09-07T08:41:13.154Z] 💓 KEEPALIVE: Sent to Deepgram
📨 Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-07T08:41:13.206Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-07T08:41:13.206Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-07T08:41:13.206Z] === END PARSED JSON ===
[2025-09-07T08:41:13.206Z] 🎯 DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-07T08:41:13.206Z] 🔇 AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-07T08:41:13.206Z] ⏰ SILENCE_START: Beginning silence tracking after AI speech
[2025-09-07T08:41:13.206Z] ✅ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 1001ms of silence
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 2002ms of silence
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 3002ms of silence
[2025-09-07T08:41:17.154Z] 💓 KEEPALIVE: Sent to Deepgram
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 4002ms of silence
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 5002ms of silence
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 6003ms of silence
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 7005ms of silence
[2025-09-07T08:41:21.154Z] 💓 KEEPALIVE: Sent to Deepgram
[2025-09-07T08:41:13.206Z] 🔇 SILENCE_CHECK: 8005ms of silence
📨 Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-07T08:41:21.705Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-07T08:41:21.705Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-07T08:41:21.705Z] === END PARSED JSON ===
[2025-09-07T08:41:21.705Z] 🎯 DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-07T08:41:21.705Z] 🎤 USER_STARTED_SPEAKING: User began speaking
[2025-09-07T08:41:21.705Z] 🔄 SILENCE_RESET: User speaking, silence tracking reset
📨 Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Let's say eleven AM."}...
Message string: {"type":"ConversationText","role":"user","content":"Let's say eleven AM."}
[2025-09-07T08:41:24.348Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Let's say eleven AM."}
[2025-09-07T08:41:24.348Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Let's say eleven AM."
}
[2025-09-07T08:41:24.348Z] === END PARSED JSON ===
[2025-09-07T08:41:24.348Z] 🎯 DEEPGRAM EVENT TYPE: ConversationText
[2025-09-07T08:41:24.348Z] 💭 CONVERSATION_TEXT: Let's say eleven AM.
📨 Received Deepgram JSON message: {"type":"History","role":"user","content":"Let's say eleven AM."}...
Message string: {"type":"History","role":"user","content":"Let's say eleven AM."}
[2025-09-07T08:41:24.358Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Let's say eleven AM."}
[2025-09-07T08:41:24.358Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Let's say eleven AM."
}
[2025-09-07T08:41:24.358Z] === END PARSED JSON ===
[2025-09-07T08:41:24.358Z] 🎯 DEEPGRAM EVENT TYPE: History
[2025-09-07T08:41:24.358Z] ❓ UNKNOWN_EVENT_TYPE: History
[2025-09-07T08:41:24.358Z] 📦 Full message: {
  "type": "History",
  "role": "user",
  "content": "Let's say eleven AM."
}
[2025-09-07T08:41:25.155Z] 💓 KEEPALIVE: Sent to Deepgram
📨 Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","arguments":"{\"date\":\"2025-09-10\"}","client_side":true}]}...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","arguments":"{\"date\":\"2025-09-10\"}","client_side":true}]}
[2025-09-07T08:41:25.281Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","arguments":"{\"date\":\"2025-09-10\"}","client_side":true}]}
[2025-09-07T08:41:25.281Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
      "name": "get_available_slots",
      "arguments": "{\"date\":\"2025-09-10\"}",
      "client_side": true
    }
  ]
}
[2025-09-07T08:41:25.281Z] === END PARSED JSON ===
[2025-09-07T08:41:25.281Z] 🎯 DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-07T08:41:25.281Z] 🚨🚨 FUNCTION_CALL_REQUEST DETECTED! 🚨🚨
[2025-09-07T08:41:25.281Z] ✅ SUCCESS: AI requesting function calls!
[2025-09-07T08:41:25.281Z] 📋 Functions: [
  {
    "id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
    "name": "get_available_slots",
    "arguments": "{\"date\":\"2025-09-10\"}",
    "client_side": true
  }
]
[2025-09-07T08:41:25.281Z] ⏸️ KEEPALIVE: Paused for function processing
[2025-09-07T08:41:25.281Z] 🔧 Processing function: get_available_slots
[2025-09-07T08:41:25.281Z] 🔧 CALLING: handleFunctionCall for get_available_slots...
📝 Session updated for call CA84be13962d0b54735a984ec955fb3faf: { callerPhone: '+447468306825' }
[2025-09-07T08:41:25.281Z] 🚀 STARTING handleFunctionCall
[2025-09-07T08:41:25.281Z] 🔧 Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
  "parameters": {
    "date": "2025-09-10"
  }
}
[2025-09-07T08:41:25.281Z] 📋 Function name: get_available_slots
[2025-09-07T08:41:25.281Z] 📊 Parameters: {
  "date": "2025-09-10"
}
[2025-09-07T08:41:25.281Z] 🏢 Business config exists: true
[2025-09-07T08:41:25.281Z] 🌐 WebSocket state: 1
🔧 Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
  "parameters": {
    "date": "2025-09-10"
  }
}
[2025-09-07T08:41:25.281Z] 🚀 STARTING getAvailableSlots with params: {
  "date": "2025-09-10"
}
[2025-09-07T08:41:25.281Z] 🏢 Business config: Gents Barbershop
[2025-09-07T08:41:25.281Z] 📋 Services count: 2
[2025-09-07T08:41:25.281Z] 🌐 Site URL: https://www.vocalenda.com
[2025-09-07T08:41:25.281Z] 🔑 Secret exists: true
🗓️ Getting available slots for: {
  "date": "2025-09-10"
}
📅 Business open on Wednesday
📋 Using default service: haircut (Duration: 30 minutes)
[2025-09-07T08:41:25.281Z] 🌐 About to make API call:
[2025-09-07T08:41:25.281Z] 🔗 API URL: https://www.vocalenda.com/api/calendar/slots?businessId=1bb3c552-053f-40c4-b3f2-bdb51af87b52&serviceId=e5d2c688-d01f-4085-8b4e-97215b48be75&date=2025-09-10
[2025-09-07T08:41:25.281Z] 🔑 Secret exists: true
[2025-09-07T08:41:25.281Z] 🏢 Business ID: 1bb3c552-053f-40c4-b3f2-bdb51af87b52
[2025-09-07T08:41:25.281Z] 📋 Service ID: e5d2c688-d01f-4085-8b4e-97215b48be75
[2025-09-07T08:41:25.281Z] 📅 Date: 2025-09-10
[2025-09-07T08:41:25.281Z] 📡 API Response status: 500
[2025-09-07T08:41:25.281Z] 📡 API Response ok: false
[2025-09-07T08:41:25.281Z] 📅 Calendar API response: {
  "error": "Failed to get available slots"
}
[2025-09-07T08:41:25.281Z] 📊 Response type: object
[2025-09-07T08:41:25.281Z] 📊 Has slots: false
[2025-09-07T08:41:25.281Z] 📊 Slots count: 0
❌ Calendar API error: { error: 'Failed to get available slots' }
✅ Sending get_available_slots response to Deepgram
✅ Function response sent successfully to Deepgram
🔄 Waiting for Deepgram to process the response...
📨 Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-10\"}","response":"{\"error\":\"Failed to get...
Message string: {"type":"History","function_calls":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-10\"}","response":"{\"error\":\"Failed to get available slots\"}"}]}
[2025-09-07T08:41:27.454Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_WiIKCVV8hNrzCGDEVv1SFYVt","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-10\"}","response":"{\"error\":\"Failed to get available slots\"}"}]}
[2025-09-07T08:41:27.454Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
      "name": "get_available_slots",
      "client_side": true,
      "arguments": "{\"date\":\"2025-09-10\"}",
      "response": "{\"error\":\"Failed to get available slots\"}"
    }
  ]
}
[2025-09-07T08:41:27.454Z] === END PARSED JSON ===
[2025-09-07T08:41:27.454Z] 🎯 DEEPGRAM EVENT TYPE: History
[2025-09-07T08:41:27.454Z] ❓ UNKNOWN_EVENT_TYPE: History
[2025-09-07T08:41:27.454Z] 📦 Full message: {
  "type": "History",
  "function_calls": [
    {
      "id": "call_WiIKCVV8hNrzCGDEVv1SFYVt",
      "name": "get_available_slots",
      "client_side": true,
      "arguments": "{\"date\":\"2025-09-10\"}",
      "response": "{\"error\":\"Failed to get available slots\"}"
    }
  ]
}
[2025-09-07T08:41:25.281Z] ✅ COMPLETED: handleFunctionCall for get_available_slots
[2025-09-07T08:41:28.302Z] ▶️ KEEPALIVE: Resumed after function processing
📨 Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}...
Message string: {"type":"ConversationText","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}
[2025-09-07T08:41:28.379Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}
[2025-09-07T08:41:28.379Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "I'm still having trouble accessing the available times for Wednesday at the moment."
}
[2025-09-07T08:41:28.379Z] === END PARSED JSON ===
[2025-09-07T08:41:28.379Z] 🎯 DEEPGRAM EVENT TYPE: ConversationText
[2025-09-07T08:41:28.379Z] 💭 CONVERSATION_TEXT: I'm still having trouble accessing the available times for Wednesday at the moment.
📨 Received Deepgram JSON message: {"type":"History","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}...
Message string: {"type":"History","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}
[2025-09-07T08:41:28.379Z] 📨 JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"I'm still having trouble accessing the available times for Wednesday at the moment."}
[2025-09-07T08:41:28.379Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "I'm still having trouble accessing the available times for Wednesday at the moment."
}
[2025-09-07T08:41:28.379Z] === END PARSED JSON ===
[2025-09-07T08:41:28.379Z] 🎯 DEEPGRAM EVENT TYPE: History
[2025-09-07T08:41:28.379Z] ❓ UNKNOWN_EVENT_TYPE: History
[2025-09-07T08:41:28.379Z] 📦 Full message: {
  "type": "History",
  "role": "assistant",
  "content": "I'm still having trouble accessing the available times for Wednesday at the moment."
}
[2025-09-07T08:41:28.379Z] 🎵 Starting audio stream - feeding buffer
[2025-09-07T08:41:29.155Z] 💓 KEEPALIVE: Sent to Deepgram