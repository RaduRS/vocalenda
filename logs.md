
Message string: {"type":"ConversationText","role":"user","content":"Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."}
[2025-09-15T09:38:36.785Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."}
[2025-09-15T09:38:36.785Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."
}
[2025-09-15T09:38:36.785Z] === END PARSED JSON ===
[2025-09-15T09:38:36.785Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:36.785Z] üí≠ CONVERSATION_TEXT: Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday.
[2025-09-15T09:38:36.785Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."}...
Message string: {"type":"History","role":"user","content":"Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."}
[2025-09-15T09:38:36.788Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."}
[2025-09-15T09:38:36.788Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday."
}
[2025-09-15T09:38:36.788Z] === END PARSED JSON ===
[2025-09-15T09:38:36.788Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:36.788Z] üìú HISTORY: Message logged
[2025-09-15T09:38:36.788Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday.
[2025-09-15T09:38:36.788Z] üìù Added transcript: [User] Actually, can you move it to twelve third to two two? Yeah. Two PM. On Wednesday.
[2025-09-15T09:38:37.631Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"I want to confirm your requested new time."}...
Message string: {"type":"ConversationText","role":"assistant","content":"I want to confirm your requested new time."}
[2025-09-15T09:38:37.859Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"I want to confirm your requested new time."}
[2025-09-15T09:38:37.859Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "I want to confirm your requested new time."
}
[2025-09-15T09:38:37.859Z] === END PARSED JSON ===
[2025-09-15T09:38:37.859Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:37.859Z] üí≠ CONVERSATION_TEXT: I want to confirm your requested new time.
[2025-09-15T09:38:37.859Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: I want to confirm your requested new time.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"I want to confirm your requested new time."}...
Message string: {"type":"History","role":"assistant","content":"I want to confirm your requested new time."}
[2025-09-15T09:38:37.860Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"I want to confirm your requested new time."}
[2025-09-15T09:38:37.860Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "I want to confirm your requested new time."
}
[2025-09-15T09:38:37.860Z] === END PARSED JSON ===
[2025-09-15T09:38:37.860Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:37.860Z] üìú HISTORY: Message logged
[2025-09-15T09:38:37.860Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: I want to confirm your requested new time.
[2025-09-15T09:38:37.860Z] üìù Added transcript: [AI] I want to confirm your requested new time.
[2025-09-15T09:38:37.860Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:38:38.915Z] üîá Audio stream ended (timeout)
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}
[2025-09-15T09:38:40.742Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}
[2025-09-15T09:38:40.742Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Did you mean 12:32 PM or 2:00 PM on Wednesday?"
}
[2025-09-15T09:38:40.742Z] === END PARSED JSON ===
[2025-09-15T09:38:40.742Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:40.742Z] üí≠ CONVERSATION_TEXT: Did you mean 12:32 PM or 2:00 PM on Wednesday?
[2025-09-15T09:38:40.742Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Did you mean 12:32 PM or 2:00 PM on Wednesday?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}...
Message string: {"type":"History","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}
[2025-09-15T09:38:40.742Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Did you mean 12:32 PM or 2:00 PM on Wednesday?"}
[2025-09-15T09:38:40.742Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Did you mean 12:32 PM or 2:00 PM on Wednesday?"
}
[2025-09-15T09:38:40.742Z] === END PARSED JSON ===
[2025-09-15T09:38:40.742Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:40.742Z] üìú HISTORY: Message logged
[2025-09-15T09:38:40.742Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Did you mean 12:32 PM or 2:00 PM on Wednesday?
[2025-09-15T09:38:40.742Z] üìù Added transcript: [AI] Did you mean 12:32 PM or 2:00 PM on Wednesday?
[2025-09-15T09:38:40.743Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:38:40.891Z] üîá Audio stream ended (timeout)
[2025-09-15T09:38:41.631Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Could you please clarify?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Could you please clarify?"}
[2025-09-15T09:38:44.664Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Could you please clarify?"}
[2025-09-15T09:38:44.664Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Could you please clarify?"
}
[2025-09-15T09:38:44.664Z] === END PARSED JSON ===
[2025-09-15T09:38:44.664Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:44.664Z] üí≠ CONVERSATION_TEXT: Could you please clarify?
[2025-09-15T09:38:44.664Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Could you please clarify?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Could you please clarify?"}...
Message string: {"type":"History","role":"assistant","content":"Could you please clarify?"}
[2025-09-15T09:38:44.664Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Could you please clarify?"}
[2025-09-15T09:38:44.664Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Could you please clarify?"
}
[2025-09-15T09:38:44.664Z] === END PARSED JSON ===
[2025-09-15T09:38:44.664Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:44.664Z] üìú HISTORY: Message logged
[2025-09-15T09:38:44.664Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Could you please clarify?
[2025-09-15T09:38:44.664Z] üìù Added transcript: [AI] Could you please clarify?
[2025-09-15T09:38:44.664Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-15T09:38:44.665Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-15T09:38:44.665Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-15T09:38:44.665Z] === END PARSED JSON ===
[2025-09-15T09:38:44.665Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-15T09:38:44.665Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-15T09:38:44.665Z] üîá SILENCE: Started tracking
[2025-09-15T09:38:44.665Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-15T09:38:45.631Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:38:44.665Z] üîá SILENCE_CHECK: 999ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:38:46.176Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:38:46.176Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:38:46.176Z] === END PARSED JSON ===
[2025-09-15T09:38:46.176Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:38:46.176Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:38:46.176Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:38:46.176Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Two."}...
Message string: {"type":"ConversationText","role":"user","content":"Two."}
[2025-09-15T09:38:46.197Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Two."}
[2025-09-15T09:38:46.197Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Two."
}
[2025-09-15T09:38:46.197Z] === END PARSED JSON ===
[2025-09-15T09:38:46.197Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:46.197Z] üí≠ CONVERSATION_TEXT: Two.
[2025-09-15T09:38:46.197Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Two.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Two."}...
Message string: {"type":"History","role":"user","content":"Two."}
[2025-09-15T09:38:46.207Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Two."}
[2025-09-15T09:38:46.207Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Two."
}
[2025-09-15T09:38:46.207Z] === END PARSED JSON ===
[2025-09-15T09:38:46.207Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:46.207Z] üìú HISTORY: Message logged
[2025-09-15T09:38:46.207Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Two.
[2025-09-15T09:38:46.207Z] üìù Added transcript: [User] Two.
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_Wj9Me25rST6LVy3WUAlRdZO8","name":"update_booking","arguments":"{\"new_time\":\"14:00\"}","client_side":true}]}...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_Wj9Me25rST6LVy3WUAlRdZO8","name":"update_booking","arguments":"{\"new_time\":\"14:00\"}","client_side":true}]}
[2025-09-15T09:38:46.984Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_Wj9Me25rST6LVy3WUAlRdZO8","name":"update_booking","arguments":"{\"new_time\":\"14:00\"}","client_side":true}]}
[2025-09-15T09:38:46.984Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_Wj9Me25rST6LVy3WUAlRdZO8",
      "name": "update_booking",
      "arguments": "{\"new_time\":\"14:00\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:38:46.984Z] === END PARSED JSON ===
[2025-09-15T09:38:46.984Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:38:46.984Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:38:46.984Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:38:46.984Z] üìã Functions: [
  {
    "id": "call_Wj9Me25rST6LVy3WUAlRdZO8",
    "name": "update_booking",
    "arguments": "{\"new_time\":\"14:00\"}",
    "client_side": true
  }
]
[2025-09-15T09:38:46.984Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:38:46.985Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:38:46.984Z] üîß Processing function: update_booking
[2025-09-15T09:38:46.984Z] üîß CALLING: handleFunctionCall for update_booking...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '12:45',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
[2025-09-15T09:38:46.985Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:38:46.985Z] üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_Wj9Me25rST6LVy3WUAlRdZO8",
  "parameters": {
    "new_time": "14:00"
  }
}
[2025-09-15T09:38:46.985Z] üìã Function name: update_booking
[2025-09-15T09:38:46.985Z] üìä Parameters: {
  "new_time": "14:00"
}
[2025-09-15T09:38:46.985Z] üè¢ Business config exists: true
[2025-09-15T09:38:46.985Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_Wj9Me25rST6LVy3WUAlRdZO8",
  "parameters": {
    "new_time": "14:00"
  }
}
üìù updateBooking called with params: {
  "new_time": "14:00"
}
üìã Session data: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '12:45',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üîÑ Using customer info: {
  customerName: 'Marco',
  currentDate: '2025-09-17',
  currentTime: '12:45'
}
üìû Caller phone: +447468306825
üë§ Customer: Marco
üìÖ Booking: 2025-09-17 at 12:45
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üì¶ Update request body: {
  "business_id": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "customer_name": "Marco",
  "current_date": "2025-09-17",
  "current_time": "12:45",
  "caller_phone": "+447468306825",
  "new_time": "14:00"
}
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:38:46.995Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:38:46.995Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:38:46.995Z] === END PARSED JSON ===
[2025-09-15T09:38:46.995Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:38:46.995Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:38:46.995Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:38:46.995Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Two PM on Wednesday. I want to move it"}...
Message string: {"type":"ConversationText","role":"user","content":"Two PM on Wednesday. I want to move it"}
[2025-09-15T09:38:48.844Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Two PM on Wednesday. I want to move it"}
[2025-09-15T09:38:48.844Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Two PM on Wednesday. I want to move it"
}
[2025-09-15T09:38:48.844Z] === END PARSED JSON ===
[2025-09-15T09:38:48.844Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:48.844Z] üí≠ CONVERSATION_TEXT: Two PM on Wednesday. I want to move it
[2025-09-15T09:38:48.844Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Two PM on Wednesday. I want to move it
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Two PM on Wednesday. I want to move it"}...
Message string: {"type":"History","role":"user","content":"Two PM on Wednesday. I want to move it"}
[2025-09-15T09:38:48.847Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Two PM on Wednesday. I want to move it"}
[2025-09-15T09:38:48.847Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Two PM on Wednesday. I want to move it"
}
[2025-09-15T09:38:48.847Z] === END PARSED JSON ===
[2025-09-15T09:38:48.847Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:48.847Z] üìú HISTORY: Message logged
[2025-09-15T09:38:48.847Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Two PM on Wednesday. I want to move it
[2025-09-15T09:38:48.847Z] üìù Added transcript: [User] Two PM on Wednesday. I want to move it
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","client_side":true}]}...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","client_side":true}]}
[2025-09-15T09:38:49.959Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","client_side":true}]}
[2025-09-15T09:38:49.959Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_Cdxo31IPNR56DQ7HH3s1wg8m",
      "name": "update_booking",
      "arguments": "{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:38:49.959Z] === END PARSED JSON ===
[2025-09-15T09:38:49.959Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:38:49.959Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:38:49.959Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:38:49.959Z] üìã Functions: [
  {
    "id": "call_Cdxo31IPNR56DQ7HH3s1wg8m",
    "name": "update_booking",
    "arguments": "{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}",
    "client_side": true
  }
]
[2025-09-15T09:38:49.959Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:38:49.959Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:38:49.959Z] üîß Processing function: update_booking
[2025-09-15T09:38:49.959Z] üîß CALLING: handleFunctionCall for update_booking...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
[2025-09-15T09:38:49.959Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:38:49.959Z] üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_Cdxo31IPNR56DQ7HH3s1wg8m",
  "parameters": {
    "new_date": "2025-09-17",
    "new_time": "14:00"
  }
}
[2025-09-15T09:38:49.959Z] üìã Function name: update_booking
[2025-09-15T09:38:49.959Z] üìä Parameters: {
  "new_date": "2025-09-17",
  "new_time": "14:00"
}
[2025-09-15T09:38:49.959Z] üè¢ Business config exists: true
[2025-09-15T09:38:49.959Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_Cdxo31IPNR56DQ7HH3s1wg8m",
  "parameters": {
    "new_date": "2025-09-17",
    "new_time": "14:00"
  }
}
üìù updateBooking called with params: {
  "new_date": "2025-09-17",
  "new_time": "14:00"
}
üìã Session data: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üîÑ Using customer info: {
  customerName: 'Marco',
  currentDate: '2025-09-17',
  currentTime: '14:00'
}
üìû Caller phone: +447468306825
üë§ Customer: Marco
üìÖ Booking: 2025-09-17 at 14:00
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üì¶ Update request body: {
  "business_id": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "customer_name": "Marco",
  "current_date": "2025-09-17",
  "current_time": "14:00",
  "caller_phone": "+447468306825",
  "new_date": "2025-09-17",
  "new_time": "14:00"
}
‚úÖ Booking updated successfully: {
  success: true,
  message: 'Booking updated successfully',
  booking: {
    id: '9ddf3e55-6823-45ff-8e48-761e1478cf04',
    customer_name: 'Marco',
    service_name: 'beard trim',
    date: '2025-09-17',
    start_time: '14:00:00',
    end_time: '13:15:00',
    status: 'confirmed'
  }
}
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '9ddf3e55-6823-45ff-8e48-761e1478cf04',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
‚úÖ Sending update_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
[2025-09-15T09:38:46.984Z] ‚úÖ COMPLETED: handleFunctionCall for update_booking
[2025-09-15T09:38:50.986Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-15T09:38:46.984Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
‚úÖ Booking updated successfully: {
  success: true,
  message: 'Booking updated successfully',
  booking: {
    id: 'adaf6700-7750-45e7-86cb-9e42707b4654',
    customer_name: 'Marco',
    service_name: 'haircut',
    date: '2025-09-17',
    start_time: '14:00:00',
    end_time: '13:30:00',
    status: 'confirmed'
  }
}
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
‚úÖ Sending update_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","response":"{\"s...
Message string: {"type":"History","function_calls":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","response":"{\"success\":true,\"message\":\"Booking updated successfully for undefined\",\"booking\":{\"id\":\"adaf6700-7750-45e7-86cb-9e42707b4654\",\"customer_name\":\"Marco\",\"service_name\":\"haircut\",\"date\":\"2025-09-17\",\"start_time\":\"14:00:00\",\"end_time\":\"13:30:00\",\"status\":\"confirmed\"}}"}]}
[2025-09-15T09:38:52.640Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_Cdxo31IPNR56DQ7HH3s1wg8m","name":"update_booking","client_side":true,"arguments":"{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}","response":"{\"success\":true,\"message\":\"Booking updated successfully for undefined\",\"booking\":{\"id\":\"adaf6700-7750-45e7-86cb-9e42707b4654\",\"customer_name\":\"Marco\",\"service_name\":\"haircut\",\"date\":\"2025-09-17\",\"start_time\":\"14:00:00\",\"end_time\":\"13:30:00\",\"status\":\"confirmed\"}}"}]}
[2025-09-15T09:38:52.640Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_Cdxo31IPNR56DQ7HH3s1wg8m",
      "name": "update_booking",
      "client_side": true,
      "arguments": "{\"new_date\":\"2025-09-17\",\"new_time\":\"14:00\"}",
      "response": "{\"success\":true,\"message\":\"Booking updated successfully for undefined\",\"booking\":{\"id\":\"adaf6700-7750-45e7-86cb-9e42707b4654\",\"customer_name\":\"Marco\",\"service_name\":\"haircut\",\"date\":\"2025-09-17\",\"start_time\":\"14:00:00\",\"end_time\":\"13:30:00\",\"status\":\"confirmed\"}}"
    }
  ]
}
[2025-09-15T09:38:52.640Z] === END PARSED JSON ===
[2025-09-15T09:38:52.640Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:52.640Z] üìú HISTORY: Message logged
[2025-09-15T09:38:49.959Z] ‚úÖ COMPLETED: handleFunctionCall for update_booking
[2025-09-15T09:38:53.492Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-15T09:38:49.959Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
[2025-09-15T09:38:53.631Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}...
Message string: {"type":"ConversationText","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}
[2025-09-15T09:38:53.879Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}
[2025-09-15T09:38:53.879Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."
}
[2025-09-15T09:38:53.879Z] === END PARSED JSON ===
[2025-09-15T09:38:53.879Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:53.879Z] üí≠ CONVERSATION_TEXT: Your appointment has been moved to 2 PM on Wednesday, 17th September 2025.
[2025-09-15T09:38:53.879Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Your appointment has been moved to 2 PM on Wednesday, 17th September 2025.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}...
Message string: {"type":"History","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}
[2025-09-15T09:38:53.880Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."}
[2025-09-15T09:38:53.880Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Your appointment has been moved to 2 PM on Wednesday, 17th September 2025."
}
[2025-09-15T09:38:53.880Z] === END PARSED JSON ===
[2025-09-15T09:38:53.880Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:53.880Z] üìú HISTORY: Message logged
[2025-09-15T09:38:53.880Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Your appointment has been moved to 2 PM on Wednesday, 17th September 2025.
[2025-09-15T09:38:53.880Z] üìù Added transcript: [AI] Your appointment has been moved to 2 PM on Wednesday, 17th September 2025.
[2025-09-15T09:38:53.880Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:38:56.148Z] üîá Audio stream ended (timeout)
[2025-09-15T09:38:57.631Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}
[2025-09-15T09:38:59.442Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}
[2025-09-15T09:38:59.442Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"
}
[2025-09-15T09:38:59.442Z] === END PARSED JSON ===
[2025-09-15T09:38:59.442Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:38:59.442Z] üí≠ CONVERSATION_TEXT: Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?
[2025-09-15T09:38:59.442Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}...
Message string: {"type":"History","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}
[2025-09-15T09:38:59.591Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"}
[2025-09-15T09:38:59.591Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?"
}
[2025-09-15T09:38:59.591Z] === END PARSED JSON ===
[2025-09-15T09:38:59.591Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:38:59.591Z] üìú HISTORY: Message logged
[2025-09-15T09:38:59.591Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?
[2025-09-15T09:38:59.591Z] üìù Added transcript: [AI] Just to confirm, do you want this to be still a beard trim, or would you like to change the service to a haircut?
[2025-09-15T09:38:59.591Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-15T09:38:59.739Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-15T09:38:59.739Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-15T09:38:59.739Z] === END PARSED JSON ===
[2025-09-15T09:38:59.739Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-15T09:38:59.739Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-15T09:38:59.739Z] üîá SILENCE: Started tracking
[2025-09-15T09:38:59.739Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 1000ms of silence
[2025-09-15T09:39:01.631Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 2001ms of silence
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 3000ms of silence
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 4001ms of silence
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 5001ms of silence
[2025-09-15T09:39:05.631Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 6001ms of silence
[2025-09-15T09:38:59.739Z] üîá SILENCE_CHECK: 7002ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:07.495Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:07.495Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:07.495Z] === END PARSED JSON ===
[2025-09-15T09:39:07.495Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:07.495Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:07.495Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:07.495Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
[2025-09-15T09:39:09.631Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"I want a beer trim."}...
Message string: {"type":"ConversationText","role":"user","content":"I want a beer trim."}
[2025-09-15T09:39:10.462Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"I want a beer trim."}
[2025-09-15T09:39:10.462Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "I want a beer trim."
}
[2025-09-15T09:39:10.462Z] === END PARSED JSON ===
[2025-09-15T09:39:10.462Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:10.462Z] üí≠ CONVERSATION_TEXT: I want a beer trim.
[2025-09-15T09:39:10.462Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: I want a beer trim.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"I want a beer trim."}...
Message string: {"type":"History","role":"user","content":"I want a beer trim."}
[2025-09-15T09:39:10.468Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"I want a beer trim."}
[2025-09-15T09:39:10.468Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "I want a beer trim."
}
[2025-09-15T09:39:10.468Z] === END PARSED JSON ===
[2025-09-15T09:39:10.468Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:10.468Z] üìú HISTORY: Message logged
[2025-09-15T09:39:10.468Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: I want a beer trim.
[2025-09-15T09:39:10.468Z] üìù Added transcript: [User] I want a beer trim.
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:10.775Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:10.775Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:10.775Z] === END PARSED JSON ===
[2025-09-15T09:39:10.775Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:10.775Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:10.775Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:10.775Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Yeah. Just just leave it there."}...
Message string: {"type":"ConversationText","role":"user","content":"Yeah. Just just leave it there."}
[2025-09-15T09:39:13.024Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Yeah. Just just leave it there."}
[2025-09-15T09:39:13.024Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Yeah. Just just leave it there."
}
[2025-09-15T09:39:13.024Z] === END PARSED JSON ===
[2025-09-15T09:39:13.024Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:13.024Z] üí≠ CONVERSATION_TEXT: Yeah. Just just leave it there.
[2025-09-15T09:39:13.024Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Yeah. Just just leave it there.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Yeah. Just just leave it there."}...
Message string: {"type":"History","role":"user","content":"Yeah. Just just leave it there."}
[2025-09-15T09:39:13.028Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Yeah. Just just leave it there."}
[2025-09-15T09:39:13.028Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Yeah. Just just leave it there."
}
[2025-09-15T09:39:13.028Z] === END PARSED JSON ===
[2025-09-15T09:39:13.028Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:13.028Z] üìú HISTORY: Message logged
[2025-09-15T09:39:13.028Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Yeah. Just just leave it there.
[2025-09-15T09:39:13.028Z] üìù Added transcript: [User] Yeah. Just just leave it there.
[2025-09-15T09:39:13.632Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_YsSUFU7L2ydIcHgzPCA3NgYf","name":"update_booking","arguments":"{\"new_service_id\":\"63555ab0-f0ac-48c3-a2b2-766356aeb8f4\"}","client_side":true}...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_YsSUFU7L2ydIcHgzPCA3NgYf","name":"update_booking","arguments":"{\"new_service_id\":\"63555ab0-f0ac-48c3-a2b2-766356aeb8f4\"}","client_side":true}]}
[2025-09-15T09:39:14.225Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_YsSUFU7L2ydIcHgzPCA3NgYf","name":"update_booking","arguments":"{\"new_service_id\":\"63555ab0-f0ac-48c3-a2b2-766356aeb8f4\"}","client_side":true}]}
[2025-09-15T09:39:14.225Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_YsSUFU7L2ydIcHgzPCA3NgYf",
      "name": "update_booking",
      "arguments": "{\"new_service_id\":\"63555ab0-f0ac-48c3-a2b2-766356aeb8f4\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:39:14.225Z] === END PARSED JSON ===
[2025-09-15T09:39:14.225Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:39:14.225Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:39:14.225Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:39:14.225Z] üìã Functions: [
  {
    "id": "call_YsSUFU7L2ydIcHgzPCA3NgYf",
    "name": "update_booking",
    "arguments": "{\"new_service_id\":\"63555ab0-f0ac-48c3-a2b2-766356aeb8f4\"}",
    "client_side": true
  }
]
[2025-09-15T09:39:14.225Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:39:14.225Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:39:14.225Z] üîß Processing function: update_booking
[2025-09-15T09:39:14.225Z] üîß CALLING: handleFunctionCall for update_booking...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
[2025-09-15T09:39:14.225Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:39:14.225Z] üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_YsSUFU7L2ydIcHgzPCA3NgYf",
  "parameters": {
    "new_service_id": "63555ab0-f0ac-48c3-a2b2-766356aeb8f4"
  }
}
[2025-09-15T09:39:14.225Z] üìã Function name: update_booking
[2025-09-15T09:39:14.225Z] üìä Parameters: {
  "new_service_id": "63555ab0-f0ac-48c3-a2b2-766356aeb8f4"
}
[2025-09-15T09:39:14.225Z] üè¢ Business config exists: true
[2025-09-15T09:39:14.225Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "update_booking",
  "function_call_id": "call_YsSUFU7L2ydIcHgzPCA3NgYf",
  "parameters": {
    "new_service_id": "63555ab0-f0ac-48c3-a2b2-766356aeb8f4"
  }
}
üìù updateBooking called with params: {
  "new_service_id": "63555ab0-f0ac-48c3-a2b2-766356aeb8f4"
}
üìã Session data: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üîÑ Using customer info: {
  customerName: 'Marco',
  currentDate: '2025-09-17',
  currentTime: '14:00'
}
üìû Caller phone: +447468306825
üë§ Customer: Marco
üìÖ Booking: 2025-09-17 at 14:00
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üì¶ Update request body: {
  "business_id": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "customer_name": "Marco",
  "current_date": "2025-09-17",
  "current_time": "14:00",
  "caller_phone": "+447468306825",
  "new_service_id": "63555ab0-f0ac-48c3-a2b2-766356aeb8f4"
}
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:14.475Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:14.475Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:14.475Z] === END PARSED JSON ===
[2025-09-15T09:39:14.475Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:14.475Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:14.475Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:14.475Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Okay. And I also want a haircut for"}...
Message string: {"type":"ConversationText","role":"user","content":"Okay. And I also want a haircut for"}
[2025-09-15T09:39:16.828Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Okay. And I also want a haircut for"}
[2025-09-15T09:39:16.828Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Okay. And I also want a haircut for"
}
[2025-09-15T09:39:16.828Z] === END PARSED JSON ===
[2025-09-15T09:39:16.828Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:16.828Z] üí≠ CONVERSATION_TEXT: Okay. And I also want a haircut for
[2025-09-15T09:39:16.828Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Okay. And I also want a haircut for
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Okay. And I also want a haircut for"}...
Message string: {"type":"History","role":"user","content":"Okay. And I also want a haircut for"}
[2025-09-15T09:39:16.847Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Okay. And I also want a haircut for"}
[2025-09-15T09:39:16.847Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Okay. And I also want a haircut for"
}
[2025-09-15T09:39:16.847Z] === END PARSED JSON ===
[2025-09-15T09:39:16.847Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:16.847Z] üìú HISTORY: Message logged
[2025-09-15T09:39:16.847Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Okay. And I also want a haircut for
[2025-09-15T09:39:16.847Z] üìù Added transcript: [User] Okay. And I also want a haircut for
‚úÖ Booking updated successfully: {
  success: true,
  message: 'Booking updated successfully',
  booking: {
    id: '4ca68442-2f04-486e-998f-9e945845cc4b',
    customer_name: 'Marco',
    service_name: 'beard trim',
    date: '2025-09-17',
    start_time: '14:00:00',
    end_time: '13:15:00',
    status: 'confirmed'
  }
}
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
‚úÖ Sending update_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:17.337Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:17.337Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:17.337Z] === END PARSED JSON ===
[2025-09-15T09:39:17.337Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:17.337Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:17.337Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:17.337Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
[2025-09-15T09:39:14.225Z] ‚úÖ COMPLETED: handleFunctionCall for update_booking
[2025-09-15T09:39:17.985Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-15T09:39:14.225Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Thursday at two PM."}...
Message string: {"type":"ConversationText","role":"user","content":"Thursday at two PM."}
[2025-09-15T09:39:18.783Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Thursday at two PM."}
[2025-09-15T09:39:18.783Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Thursday at two PM."
}
[2025-09-15T09:39:18.783Z] === END PARSED JSON ===
[2025-09-15T09:39:18.783Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:18.783Z] üí≠ CONVERSATION_TEXT: Thursday at two PM.
[2025-09-15T09:39:18.783Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Thursday at two PM.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Thursday at two PM."}...
Message string: {"type":"History","role":"user","content":"Thursday at two PM."}
[2025-09-15T09:39:18.787Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Thursday at two PM."}
[2025-09-15T09:39:18.787Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Thursday at two PM."
}
[2025-09-15T09:39:18.787Z] === END PARSED JSON ===
[2025-09-15T09:39:18.787Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:18.787Z] üìú HISTORY: Message logged
[2025-09-15T09:39:18.787Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Thursday at two PM.
[2025-09-15T09:39:18.787Z] üìù Added transcript: [User] Thursday at two PM.
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}","client_side":true}]}
[2025-09-15T09:39:19.774Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}","client_side":true}]}
[2025-09-15T09:39:19.774Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_VXKnwaMLST1vL0CBTpYfDuDF",
      "name": "get_available_slots",
      "arguments": "{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:39:19.774Z] === END PARSED JSON ===
[2025-09-15T09:39:19.774Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:39:19.774Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:39:19.774Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:39:19.774Z] üìã Functions: [
  {
    "id": "call_VXKnwaMLST1vL0CBTpYfDuDF",
    "name": "get_available_slots",
    "arguments": "{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}",
    "client_side": true
  }
]
[2025-09-15T09:39:19.774Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:39:19.774Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:39:19.774Z] üîß Processing function: get_available_slots
[2025-09-15T09:39:19.774Z] üîß CALLING: handleFunctionCall for get_available_slots...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
[2025-09-15T09:39:19.775Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:39:19.775Z] üîß Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_VXKnwaMLST1vL0CBTpYfDuDF",
  "parameters": {
    "date": "2025-09-18",
    "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4"
  }
}
[2025-09-15T09:39:19.775Z] üìã Function name: get_available_slots
[2025-09-15T09:39:19.775Z] üìä Parameters: {
  "date": "2025-09-18",
  "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4"
}
[2025-09-15T09:39:19.775Z] üè¢ Business config exists: true
[2025-09-15T09:39:19.775Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "get_available_slots",
  "function_call_id": "call_VXKnwaMLST1vL0CBTpYfDuDF",
  "parameters": {
    "date": "2025-09-18",
    "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4"
  }
}
[2025-09-15T09:39:19.775Z] üöÄ STARTING getAvailableSlots with params: {
  "date": "2025-09-18",
  "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4"
}
[2025-09-15T09:39:19.775Z] üè¢ Business config: Gents Barbershop
[2025-09-15T09:39:19.775Z] üìã Services count: 2
[2025-09-15T09:39:19.775Z] üåê Site URL: https://www.vocalenda.com
[2025-09-15T09:39:19.775Z] üîë Secret exists: true
üóìÔ∏è Getting available slots for: {
  "date": "2025-09-18",
  "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4"
}
üìÖ Business open on Thursday
üìã Using service: haircut (Duration: 30 minutes)
[2025-09-15T09:39:19.775Z] üåê About to make API call:
[2025-09-15T09:39:19.775Z] üîó API URL: https://www.vocalenda.com/api/calendar/availability?businessId=1bb3c552-053f-40c4-b3f2-bdb51af87b52&serviceId=4395775e-fa81-4a69-8425-e46c3853dea4&date=2025-09-18
[2025-09-15T09:39:19.775Z] üîë Secret exists: true
[2025-09-15T09:39:19.775Z] üè¢ Business ID: 1bb3c552-053f-40c4-b3f2-bdb51af87b52
[2025-09-15T09:39:19.775Z] üìã Service ID: 4395775e-fa81-4a69-8425-e46c3853dea4
[2025-09-15T09:39:19.775Z] üìÖ Date: 2025-09-18
[2025-09-15T09:39:19.775Z] üì° API Response status: 200
[2025-09-15T09:39:19.775Z] üì° API Response ok: true
[2025-09-15T09:39:19.775Z] üìÖ Calendar API response: {
  "slots": [
    {
      "start": "2025-09-18T08:00:00.000Z",
      "end": "2025-09-18T08:30:00.000Z",
      "startTime": "09:00",
      "endTime": "09:30"
    },
    {
      "start": "2025-09-18T08:15:00.000Z",
      "end": "2025-09-18T08:45:00.000Z",
      "startTime": "09:15",
      "endTime": "09:45"
    },
    {
      "start": "2025-09-18T08:30:00.000Z",
      "end": "2025-09-18T09:00:00.000Z",
      "startTime": "09:30",
      "endTime": "10:00"
    },
    {
      "start": "2025-09-18T08:45:00.000Z",
      "end": "2025-09-18T09:15:00.000Z",
      "startTime": "09:45",
      "endTime": "10:15"
    },
    {
      "start": "2025-09-18T09:00:00.000Z",
      "end": "2025-09-18T09:30:00.000Z",
      "startTime": "10:00",
      "endTime": "10:30"
    },
    {
      "start": "2025-09-18T09:15:00.000Z",
      "end": "2025-09-18T09:45:00.000Z",
      "startTime": "10:15",
      "endTime": "10:45"
    },
    {
      "start": "2025-09-18T09:30:00.000Z",
      "end": "2025-09-18T10:00:00.000Z",
      "startTime": "10:30",
      "endTime": "11:00"
    },
    {
      "start": "2025-09-18T09:45:00.000Z",
      "end": "2025-09-18T10:15:00.000Z",
      "startTime": "10:45",
      "endTime": "11:15"
    },
    {
      "start": "2025-09-18T10:00:00.000Z",
      "end": "2025-09-18T10:30:00.000Z",
      "startTime": "11:00",
      "endTime": "11:30"
    },
    {
      "start": "2025-09-18T10:15:00.000Z",
      "end": "2025-09-18T10:45:00.000Z",
      "startTime": "11:15",
      "endTime": "11:45"
    },
    {
      "start": "2025-09-18T10:30:00.000Z",
      "end": "2025-09-18T11:00:00.000Z",
      "startTime": "11:30",
      "endTime": "12:00"
    },
    {
      "start": "2025-09-18T12:15:00.000Z",
      "end": "2025-09-18T12:45:00.000Z",
      "startTime": "13:15",
      "endTime": "13:45"
    },
    {
      "start": "2025-09-18T12:30:00.000Z",
      "end": "2025-09-18T13:00:00.000Z",
      "startTime": "13:30",
      "endTime": "14:00"
    },
    {
      "start": "2025-09-18T13:30:00.000Z",
      "end": "2025-09-18T14:00:00.000Z",
      "startTime": "14:30",
      "endTime": "15:00"
    },
    {
      "start": "2025-09-18T13:45:00.000Z",
      "end": "2025-09-18T14:15:00.000Z",
      "startTime": "14:45",
      "endTime": "15:15"
    },
    {
      "start": "2025-09-18T14:00:00.000Z",
      "end": "2025-09-18T14:30:00.000Z",
      "startTime": "15:00",
      "endTime": "15:30"
    },
    {
      "start": "2025-09-18T14:15:00.000Z",
      "end": "2025-09-18T14:45:00.000Z",
      "startTime": "15:15",
      "endTime": "15:45"
    },
    {
      "start": "2025-09-18T14:30:00.000Z",
      "end": "2025-09-18T15:00:00.000Z",
      "startTime": "15:30",
      "endTime": "16:00"
    },
    {
      "start": "2025-09-18T14:45:00.000Z",
      "end": "2025-09-18T15:15:00.000Z",
      "startTime": "15:45",
      "endTime": "16:15"
    },
    {
      "start": "2025-09-18T15:00:00.000Z",
      "end": "2025-09-18T15:30:00.000Z",
      "startTime": "16:00",
      "endTime": "16:30"
    },
    {
      "start": "2025-09-18T15:15:00.000Z",
      "end": "2025-09-18T15:45:00.000Z",
      "startTime": "16:15",
      "endTime": "16:45"
    },
    {
      "start": "2025-09-18T15:30:00.000Z",
      "end": "2025-09-18T16:00:00.000Z",
      "startTime": "16:30",
      "endTime": "17:00"
    }
  ],
  "date": "2025-09-18",
  "businessId": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "serviceId": "4395775e-fa81-4a69-8425-e46c3853dea4"
}
[2025-09-15T09:39:19.775Z] üìä Response type: object
[2025-09-15T09:39:19.775Z] üìä Has slots: true
[2025-09-15T09:39:19.775Z] üìä Slots count: 22
‚úÖ Available time slots: [
  '09:00', '09:15', '09:30',
  '09:45', '10:00', '10:15',
  '10:30', '10:45', '11:00',
  '11:15', '11:30', '13:15',
  '13:30', '14:30', '14:45',
  '15:00', '15:15', '15:30',
  '15:45', '16:00', '16:15',
  '16:30'
]
‚úÖ Sending get_available_slots response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425...
Message string: {"type":"History","function_calls":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}","response":"{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"13:15\",\"13:30\",\"14:30\",\"14:45\",\"15:00\",\"15:15\",\"15:30\",\"15:45\",\"16:00\",\"16:15\",\"16:30\"]}"}]}
[2025-09-15T09:39:21.134Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_VXKnwaMLST1vL0CBTpYfDuDF","name":"get_available_slots","client_side":true,"arguments":"{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}","response":"{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"13:15\",\"13:30\",\"14:30\",\"14:45\",\"15:00\",\"15:15\",\"15:30\",\"15:45\",\"16:00\",\"16:15\",\"16:30\"]}"}]}
[2025-09-15T09:39:21.134Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_VXKnwaMLST1vL0CBTpYfDuDF",
      "name": "get_available_slots",
      "client_side": true,
      "arguments": "{\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\"}",
      "response": "{\"available_slots\":[\"09:00\",\"09:15\",\"09:30\",\"09:45\",\"10:00\",\"10:15\",\"10:30\",\"10:45\",\"11:00\",\"11:15\",\"11:30\",\"13:15\",\"13:30\",\"14:30\",\"14:45\",\"15:00\",\"15:15\",\"15:30\",\"15:45\",\"16:00\",\"16:15\",\"16:30\"]}"
    }
  ]
}
[2025-09-15T09:39:21.134Z] === END PARSED JSON ===
[2025-09-15T09:39:21.134Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:21.134Z] üìú HISTORY: Message logged
[2025-09-15T09:39:19.774Z] ‚úÖ COMPLETED: handleFunctionCall for get_available_slots
[2025-09-15T09:39:21.987Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-15T09:39:19.774Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}...
Message string: {"type":"ConversationText","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}
[2025-09-15T09:39:22.083Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}
[2025-09-15T09:39:22.083Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."
}
[2025-09-15T09:39:22.083Z] === END PARSED JSON ===
[2025-09-15T09:39:22.083Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:22.083Z] üí≠ CONVERSATION_TEXT: For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available.
[2025-09-15T09:39:22.083Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}...
Message string: {"type":"History","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}
[2025-09-15T09:39:22.084Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."}
[2025-09-15T09:39:22.084Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available."
}
[2025-09-15T09:39:22.084Z] === END PARSED JSON ===
[2025-09-15T09:39:22.084Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:22.084Z] üìú HISTORY: Message logged
[2025-09-15T09:39:22.084Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available.
[2025-09-15T09:39:22.084Z] üìù Added transcript: [AI] For the haircut on Thursday, 18th September 2025 at 2 PM, that time isn't available.
[2025-09-15T09:39:22.084Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:39:25.094Z] üîá Audio stream ended (timeout)
[2025-09-15T09:39:25.634Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}...
Message string: {"type":"ConversationText","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}
[2025-09-15T09:39:29.326Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}
[2025-09-15T09:39:29.326Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "But I have 2:30 PM or 2:45 PM available."
}
[2025-09-15T09:39:29.326Z] === END PARSED JSON ===
[2025-09-15T09:39:29.326Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:29.326Z] üí≠ CONVERSATION_TEXT: But I have 2:30 PM or 2:45 PM available.
[2025-09-15T09:39:29.326Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: But I have 2:30 PM or 2:45 PM available.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}...
Message string: {"type":"History","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}
[2025-09-15T09:39:29.326Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"But I have 2:30 PM or 2:45 PM available."}
[2025-09-15T09:39:29.326Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "But I have 2:30 PM or 2:45 PM available."
}
[2025-09-15T09:39:29.326Z] === END PARSED JSON ===
[2025-09-15T09:39:29.326Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:29.326Z] üìú HISTORY: Message logged
[2025-09-15T09:39:29.326Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: But I have 2:30 PM or 2:45 PM available.
[2025-09-15T09:39:29.326Z] üìù Added transcript: [AI] But I have 2:30 PM or 2:45 PM available.
[2025-09-15T09:39:29.326Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:39:29.633Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:39:29.621Z] üîá Audio stream ended (timeout)
[2025-09-15T09:39:33.634Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Which one works better for you?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Which one works better for you?"}
[2025-09-15T09:39:34.848Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Which one works better for you?"}
[2025-09-15T09:39:34.848Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Which one works better for you?"
}
[2025-09-15T09:39:34.848Z] === END PARSED JSON ===
[2025-09-15T09:39:34.848Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:34.848Z] üí≠ CONVERSATION_TEXT: Which one works better for you?
[2025-09-15T09:39:34.848Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Which one works better for you?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Which one works better for you?"}...
Message string: {"type":"History","role":"assistant","content":"Which one works better for you?"}
[2025-09-15T09:39:34.848Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Which one works better for you?"}
[2025-09-15T09:39:34.848Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Which one works better for you?"
}
[2025-09-15T09:39:34.848Z] === END PARSED JSON ===
[2025-09-15T09:39:34.848Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:34.848Z] üìú HISTORY: Message logged
[2025-09-15T09:39:34.848Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Which one works better for you?
[2025-09-15T09:39:34.848Z] üìù Added transcript: [AI] Which one works better for you?
[2025-09-15T09:39:34.848Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-15T09:39:34.996Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-15T09:39:34.996Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-15T09:39:34.996Z] === END PARSED JSON ===
[2025-09-15T09:39:34.996Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-15T09:39:34.996Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-15T09:39:34.996Z] üîá SILENCE: Started tracking
[2025-09-15T09:39:34.996Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-15T09:39:34.996Z] üîá SILENCE_CHECK: 1000ms of silence
[2025-09-15T09:39:34.996Z] üîá SILENCE_CHECK: 2001ms of silence
[2025-09-15T09:39:37.634Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:39:34.996Z] üîá SILENCE_CHECK: 3001ms of silence
[2025-09-15T09:39:34.996Z] üîá SILENCE_CHECK: 4001ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:39.080Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:39.080Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:39.080Z] === END PARSED JSON ===
[2025-09-15T09:39:39.080Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:39.080Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:39.080Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:39.080Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"So two forty five PM."}...
Message string: {"type":"ConversationText","role":"user","content":"So two forty five PM."}
[2025-09-15T09:39:39.661Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"So two forty five PM."}
[2025-09-15T09:39:39.661Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "So two forty five PM."
}
[2025-09-15T09:39:39.661Z] === END PARSED JSON ===
[2025-09-15T09:39:39.661Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:39.661Z] üí≠ CONVERSATION_TEXT: So two forty five PM.
[2025-09-15T09:39:39.661Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: So two forty five PM.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"So two forty five PM."}...
Message string: {"type":"History","role":"user","content":"So two forty five PM."}
[2025-09-15T09:39:39.668Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"So two forty five PM."}
[2025-09-15T09:39:39.668Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "So two forty five PM."
}
[2025-09-15T09:39:39.668Z] === END PARSED JSON ===
[2025-09-15T09:39:39.668Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:39.668Z] üìú HISTORY: Message logged
[2025-09-15T09:39:39.668Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: So two forty five PM.
[2025-09-15T09:39:39.668Z] üìù Added transcript: [User] So two forty five PM.
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa8...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}","client_side":true}]}
[2025-09-15T09:39:40.604Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}","client_side":true}]}
[2025-09-15T09:39:40.604Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_kzQwW8s8vSWvXPVjYwzVRyno",
      "name": "create_booking",
      "arguments": "{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:39:40.604Z] === END PARSED JSON ===
[2025-09-15T09:39:40.604Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:39:40.604Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:39:40.604Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:39:40.604Z] üìã Functions: [
  {
    "id": "call_kzQwW8s8vSWvXPVjYwzVRyno",
    "name": "create_booking",
    "arguments": "{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}",
    "client_side": true
  }
]
[2025-09-15T09:39:40.604Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:39:40.605Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:39:40.604Z] üîß Processing function: create_booking
[2025-09-15T09:39:40.604Z] üîß CALLING: handleFunctionCall for create_booking...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-17',
  lastBookingTime: '14:00',
  lastServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
  lastServiceName: 'beard trim',
  lastServiceDuration: 15,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
[2025-09-15T09:39:40.605Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:39:40.605Z] üîß Function call received: {
  "function_name": "create_booking",
  "function_call_id": "call_kzQwW8s8vSWvXPVjYwzVRyno",
  "parameters": {
    "customer_name": "Marco",
    "date": "2025-09-18",
    "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4",
    "time": "14:45"
  }
}
[2025-09-15T09:39:40.605Z] üìã Function name: create_booking
[2025-09-15T09:39:40.605Z] üìä Parameters: {
  "customer_name": "Marco",
  "date": "2025-09-18",
  "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4",
  "time": "14:45"
}
[2025-09-15T09:39:40.605Z] üè¢ Business config exists: true
[2025-09-15T09:39:40.605Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "create_booking",
  "function_call_id": "call_kzQwW8s8vSWvXPVjYwzVRyno",
  "parameters": {
    "customer_name": "Marco",
    "date": "2025-09-18",
    "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4",
    "time": "14:45"
  }
}
‚úÖ TRACKING: Added function call ID call_kzQwW8s8vSWvXPVjYwzVRyno to processed set
üéØ createBooking called with params: {
  "customer_name": "Marco",
  "date": "2025-09-18",
  "service_id": "4395775e-fa81-4a69-8425-e46c3853dea4",
  "time": "14:45"
}
üìã Available services: [
  { id: '4395775e-fa81-4a69-8425-e46c3853dea4', name: 'haircut' },
  { id: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4', name: 'beard trim' }
]
‚úÖ Booking - Service found: haircut (ID: 4395775e-fa81-4a69-8425-e46c3853dea4 )
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-18',
  lastBookingTime: '14:45',
  lastServiceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
  lastServiceName: 'haircut',
  lastServiceDuration: 30,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '14:45',
      serviceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
      serviceName: 'haircut',
      serviceDuration: 30,
      appointmentId: null,
      type: 'create'
    }
  ],
  lastAppointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7'
}
üïê Creating appointment for 2025-09-18 at 14:45 in timezone: Europe/London
üìÖ Parsed date: 2025-09-18 (Thursday)
üïê Appointment datetime (UK local): 14:45:00
üïê Business timezone: Europe/London
üïê Start time: 14:45:00
üïê End time: 15:15:00
üìÖ Day of week: Thursday
üîç Checking slot availability before booking...
üìã Availability check result: {
  "available": true,
  "businessId": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "serviceId": "4395775e-fa81-4a69-8425-e46c3853dea4",
  "appointmentDate": "2025-09-18",
  "startTime": "14:45:00",
  "endTime": "15:15:00",
  "message": "Slot is available"
}
‚úÖ Slot is available - proceeding with booking
üìû Calling internal Next.js booking API...
üîó API URL: https://www.vocalenda.com/api/internal/booking
üì¶ Booking data: {
  "businessId": "1bb3c552-053f-40c4-b3f2-bdb51af87b52",
  "serviceId": "4395775e-fa81-4a69-8425-e46c3853dea4",
  "appointmentDate": "2025-09-18",
  "startTime": "14:45:00",
  "endTime": "15:15:00",
  "customerName": "Marco",
  "customerPhone": "+447468306825",
  "customerEmail": null,
  "notes": "Voice booking - Customer: Marco - Phone: +447468306825"
}
üì° API Response status: 200 OK
üìã API Response body: {
  "success": true,
  "appointmentId": "99de44fe-c940-4b73-a60d-93c0d1ca6712",
  "calendarEventId": "9bs0hbp810kcle0n61vp2hbgl4"
}
‚úÖ Appointment created successfully via API: 99de44fe-c940-4b73-a60d-93c0d1ca6712
üìÖ Calendar event ID: 9bs0hbp810kcle0n61vp2hbgl4
üìû Updating call log with customer name: Marco
Failed to update call customer: {
  code: 'PGRST204',
‚úÖ Call log updated with customer name: CA20b2d8268ce7b7a3ef3351f331ad95a0
  details: null,
  hint: null,
  message: "Could not find the 'customer_name' column of 'call_logs' in the schema cache"
}
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-18',
  lastBookingTime: '14:45',
  lastServiceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
  lastServiceName: 'haircut',
  lastServiceDuration: 30,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '14:45',
      serviceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
      serviceName: 'haircut',
      serviceDuration: 30,
      appointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712',
      type: 'create'
    }
  ],
  lastAppointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712'
}
üìã Stored appointment ID in session: 99de44fe-c940-4b73-a60d-93c0d1ca6712
‚úÖ Sending create_booking response to Deepgram
‚úÖ Function response sent successfully to Deepgram
üîÑ Waiting for Deepgram to process the response...
üì® Received Deepgram JSON message: {"type":"History","function_calls":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","client_side":true,"arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"...
Message string: {"type":"History","function_calls":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","client_side":true,"arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}","response":"{\"success\":true,\"appointment_id\":\"99de44fe-c940-4b73-a60d-93c0d1ca6712\",\"calendar_event_id\":\"9bs0hbp810kcle0n61vp2hbgl4\",\"message\":\"‚úÖ BOOKING CONFIRMED: Appointment successfully booked for Marco on 2025-09-18 at 14:45 for haircut. Your appointment is confirmed and secured. Event has been added to your Google Calendar.\"}"}]}
[2025-09-15T09:39:43.405Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","function_calls":[{"id":"call_kzQwW8s8vSWvXPVjYwzVRyno","name":"create_booking","client_side":true,"arguments":"{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}","response":"{\"success\":true,\"appointment_id\":\"99de44fe-c940-4b73-a60d-93c0d1ca6712\",\"calendar_event_id\":\"9bs0hbp810kcle0n61vp2hbgl4\",\"message\":\"‚úÖ BOOKING CONFIRMED: Appointment successfully booked for Marco on 2025-09-18 at 14:45 for haircut. Your appointment is confirmed and secured. Event has been added to your Google Calendar.\"}"}]}
[2025-09-15T09:39:43.405Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "function_calls": [
    {
      "id": "call_kzQwW8s8vSWvXPVjYwzVRyno",
      "name": "create_booking",
      "client_side": true,
      "arguments": "{\"customer_name\":\"Marco\",\"date\":\"2025-09-18\",\"service_id\":\"4395775e-fa81-4a69-8425-e46c3853dea4\",\"time\":\"14:45\"}",
      "response": "{\"success\":true,\"appointment_id\":\"99de44fe-c940-4b73-a60d-93c0d1ca6712\",\"calendar_event_id\":\"9bs0hbp810kcle0n61vp2hbgl4\",\"message\":\"‚úÖ BOOKING CONFIRMED: Appointment successfully booked for Marco on 2025-09-18 at 14:45 for haircut. Your appointment is confirmed and secured. Event has been added to your Google Calendar.\"}"
    }
  ]
}
[2025-09-15T09:39:43.405Z] === END PARSED JSON ===
[2025-09-15T09:39:43.405Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:43.405Z] üìú HISTORY: Message logged
[2025-09-15T09:39:40.604Z] ‚úÖ COMPLETED: handleFunctionCall for create_booking
[2025-09-15T09:39:44.258Z] ‚ñ∂Ô∏è KEEPALIVE: Resumed after function processing
[2025-09-15T09:39:40.604Z] ‚ñ∂Ô∏è SILENCE: Resuming timer - Function processing completed
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}...
Message string: {"type":"ConversationText","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}
[2025-09-15T09:39:44.815Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}
[2025-09-15T09:39:44.815Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."
}
[2025-09-15T09:39:44.815Z] === END PARSED JSON ===
[2025-09-15T09:39:44.815Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:44.815Z] üí≠ CONVERSATION_TEXT: Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025.
[2025-09-15T09:39:44.815Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}...
Message string: {"type":"History","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}
[2025-09-15T09:39:44.816Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."}
[2025-09-15T09:39:44.816Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025."
}
[2025-09-15T09:39:44.816Z] === END PARSED JSON ===
[2025-09-15T09:39:44.816Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:44.816Z] üìú HISTORY: Message logged
[2025-09-15T09:39:44.816Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025.
[2025-09-15T09:39:44.816Z] üìù Added transcript: [AI] Your haircut appointment is confirmed for 2:45 PM on Thursday, 18th September 2025.
[2025-09-15T09:39:44.816Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:39:45.636Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:39:47.859Z] üîá Audio stream ended (timeout)
[2025-09-15T09:39:49.637Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Is there anything else I can assist you with today?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Is there anything else I can assist you with today?"}
[2025-09-15T09:39:52.137Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Is there anything else I can assist you with today?"}
[2025-09-15T09:39:52.137Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Is there anything else I can assist you with today?"
}
[2025-09-15T09:39:52.137Z] === END PARSED JSON ===
[2025-09-15T09:39:52.137Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:52.137Z] üí≠ CONVERSATION_TEXT: Is there anything else I can assist you with today?
[2025-09-15T09:39:52.137Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Is there anything else I can assist you with today?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Is there anything else I can assist you with today?"}...
Message string: {"type":"History","role":"assistant","content":"Is there anything else I can assist you with today?"}
[2025-09-15T09:39:52.138Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Is there anything else I can assist you with today?"}
[2025-09-15T09:39:52.138Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Is there anything else I can assist you with today?"
}
[2025-09-15T09:39:52.138Z] === END PARSED JSON ===
[2025-09-15T09:39:52.138Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:52.138Z] üìú HISTORY: Message logged
[2025-09-15T09:39:52.138Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Is there anything else I can assist you with today?
[2025-09-15T09:39:52.138Z] üìù Added transcript: [AI] Is there anything else I can assist you with today?
[2025-09-15T09:39:52.138Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-15T09:39:52.286Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-15T09:39:52.286Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-15T09:39:52.286Z] === END PARSED JSON ===
[2025-09-15T09:39:52.286Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-15T09:39:52.286Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-15T09:39:52.286Z] üîá SILENCE: Started tracking
[2025-09-15T09:39:52.286Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-15T09:39:52.286Z] üîá SILENCE_CHECK: 1000ms of silence
[2025-09-15T09:39:53.636Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:39:52.286Z] üîá SILENCE_CHECK: 2000ms of silence
[2025-09-15T09:39:52.286Z] üîá SILENCE_CHECK: 3000ms of silence
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:55.480Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:55.480Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:55.480Z] === END PARSED JSON ===
[2025-09-15T09:39:55.480Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:55.480Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:55.480Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:55.480Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
[2025-09-15T09:39:57.637Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Yeah. So can you tell me when my bookings are?"}...
Message string: {"type":"ConversationText","role":"user","content":"Yeah. So can you tell me when my bookings are?"}
[2025-09-15T09:39:58.382Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Yeah. So can you tell me when my bookings are?"}
[2025-09-15T09:39:58.382Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Yeah. So can you tell me when my bookings are?"
}
[2025-09-15T09:39:58.382Z] === END PARSED JSON ===
[2025-09-15T09:39:58.382Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:58.382Z] üí≠ CONVERSATION_TEXT: Yeah. So can you tell me when my bookings are?
[2025-09-15T09:39:58.382Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Yeah. So can you tell me when my bookings are?
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Yeah. So can you tell me when my bookings are?"}...
Message string: {"type":"History","role":"user","content":"Yeah. So can you tell me when my bookings are?"}
[2025-09-15T09:39:58.388Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Yeah. So can you tell me when my bookings are?"}
[2025-09-15T09:39:58.388Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Yeah. So can you tell me when my bookings are?"
}
[2025-09-15T09:39:58.388Z] === END PARSED JSON ===
[2025-09-15T09:39:58.388Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:58.388Z] üìú HISTORY: Message logged
[2025-09-15T09:39:58.388Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Yeah. So can you tell me when my bookings are?
[2025-09-15T09:39:58.388Z] üìù Added transcript: [User] Yeah. So can you tell me when my bookings are?
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:59.156Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:59.156Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:59.156Z] === END PARSED JSON ===
[2025-09-15T09:39:59.156Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:59.156Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:59.156Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:59.156Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"Both of them?"}...
Message string: {"type":"ConversationText","role":"user","content":"Both of them?"}
[2025-09-15T09:39:59.187Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"Both of them?"}
[2025-09-15T09:39:59.187Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "Both of them?"
}
[2025-09-15T09:39:59.187Z] === END PARSED JSON ===
[2025-09-15T09:39:59.187Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:39:59.187Z] üí≠ CONVERSATION_TEXT: Both of them?
[2025-09-15T09:39:59.187Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: Both of them?
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"Both of them?"}...
Message string: {"type":"History","role":"user","content":"Both of them?"}
[2025-09-15T09:39:59.188Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"Both of them?"}
[2025-09-15T09:39:59.188Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "Both of them?"
}
[2025-09-15T09:39:59.188Z] === END PARSED JSON ===
[2025-09-15T09:39:59.188Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:39:59.188Z] üìú HISTORY: Message logged
[2025-09-15T09:39:59.188Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: Both of them?
[2025-09-15T09:39:59.188Z] üìù Added transcript: [User] Both of them?
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:59.976Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:39:59.976Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:39:59.976Z] === END PARSED JSON ===
[2025-09-15T09:39:59.976Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:39:59.976Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:39:59.976Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:39:59.976Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"What time and date?"}...
Message string: {"type":"ConversationText","role":"user","content":"What time and date?"}
[2025-09-15T09:40:00.287Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"What time and date?"}
[2025-09-15T09:40:00.287Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "What time and date?"
}
[2025-09-15T09:40:00.287Z] === END PARSED JSON ===
[2025-09-15T09:40:00.287Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:00.287Z] üí≠ CONVERSATION_TEXT: What time and date?
[2025-09-15T09:40:00.287Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: What time and date?
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"What time and date?"}...
Message string: {"type":"History","role":"user","content":"What time and date?"}
[2025-09-15T09:40:00.288Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"What time and date?"}
[2025-09-15T09:40:00.288Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "What time and date?"
}
[2025-09-15T09:40:00.288Z] === END PARSED JSON ===
[2025-09-15T09:40:00.288Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:00.288Z] üìú HISTORY: Message logged
[2025-09-15T09:40:00.288Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: What time and date?
[2025-09-15T09:40:00.288Z] üìù Added transcript: [User] What time and date?
[2025-09-15T09:40:01.637Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"You have two appointments booked:\n1."}...
Message string: {"type":"ConversationText","role":"assistant","content":"You have two appointments booked:\n1."}
[2025-09-15T09:40:01.867Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"You have two appointments booked:\n1."}
[2025-09-15T09:40:01.867Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "You have two appointments booked:\n1."
}
[2025-09-15T09:40:01.867Z] === END PARSED JSON ===
[2025-09-15T09:40:01.867Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:01.867Z] üí≠ CONVERSATION_TEXT: You have two appointments booked:
1.
[2025-09-15T09:40:01.867Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: You have two appointments booked:
1.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"You have two appointments booked:\n1."}...
Message string: {"type":"History","role":"assistant","content":"You have two appointments booked:\n1."}
[2025-09-15T09:40:01.867Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"You have two appointments booked:\n1."}
[2025-09-15T09:40:01.867Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "You have two appointments booked:\n1."
}
[2025-09-15T09:40:01.867Z] === END PARSED JSON ===
[2025-09-15T09:40:01.867Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:01.867Z] üìú HISTORY: Message logged
[2025-09-15T09:40:01.867Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: You have two appointments booked:
1.
[2025-09-15T09:40:01.867Z] üìù Added transcript: [AI] You have two appointments booked:
1.
[2025-09-15T09:40:01.868Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:40:02.950Z] üîá Audio stream ended (timeout)
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}...
Message string: {"type":"ConversationText","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}
[2025-09-15T09:40:04.790Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}
[2025-09-15T09:40:04.790Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Beard trim on Wednesday, 17th September 2025 at 2 PM."
}
[2025-09-15T09:40:04.790Z] === END PARSED JSON ===
[2025-09-15T09:40:04.790Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:04.790Z] üí≠ CONVERSATION_TEXT: Beard trim on Wednesday, 17th September 2025 at 2 PM.
[2025-09-15T09:40:04.790Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Beard trim on Wednesday, 17th September 2025 at 2 PM.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}...
Message string: {"type":"History","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}
[2025-09-15T09:40:04.938Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Beard trim on Wednesday, 17th September 2025 at 2 PM."}
[2025-09-15T09:40:04.938Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Beard trim on Wednesday, 17th September 2025 at 2 PM."
}
[2025-09-15T09:40:04.938Z] === END PARSED JSON ===
[2025-09-15T09:40:04.938Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:04.938Z] üìú HISTORY: Message logged
[2025-09-15T09:40:04.938Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Beard trim on Wednesday, 17th September 2025 at 2 PM.
[2025-09-15T09:40:04.938Z] üìù Added transcript: [AI] Beard trim on Wednesday, 17th September 2025 at 2 PM.
[2025-09-15T09:40:04.938Z] üéµ Starting audio stream - feeding buffer
     ==> Detected service running on port 8080
     ==> Docs on specifying a port: https://render.com/docs/web-services#port-binding
[2025-09-15T09:40:05.637Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:40:05.838Z] üîá Audio stream ended (timeout)
[2025-09-15T09:40:09.637Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"2."}...
Message string: {"type":"ConversationText","role":"assistant","content":"2."}
[2025-09-15T09:40:11.152Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"2."}
[2025-09-15T09:40:11.152Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "2."
}
[2025-09-15T09:40:11.152Z] === END PARSED JSON ===
[2025-09-15T09:40:11.152Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:11.152Z] üí≠ CONVERSATION_TEXT: 2.
[2025-09-15T09:40:11.152Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: 2.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"2."}...
Message string: {"type":"History","role":"assistant","content":"2."}
[2025-09-15T09:40:11.152Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"2."}
[2025-09-15T09:40:11.152Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "2."
}
[2025-09-15T09:40:11.152Z] === END PARSED JSON ===
[2025-09-15T09:40:11.152Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:11.152Z] üìú HISTORY: Message logged
[2025-09-15T09:40:11.152Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: 2.
[2025-09-15T09:40:11.152Z] üìù Added transcript: [AI] 2.
[2025-09-15T09:40:11.152Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:40:11.168Z] üîá Audio stream ended (timeout)
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}...
Message string: {"type":"ConversationText","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}
[2025-09-15T09:40:11.714Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}
[2025-09-15T09:40:11.714Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Haircut on Thursday, 18th September 2025 at 2:45 PM."
}
[2025-09-15T09:40:11.714Z] === END PARSED JSON ===
[2025-09-15T09:40:11.714Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:11.714Z] üí≠ CONVERSATION_TEXT: Haircut on Thursday, 18th September 2025 at 2:45 PM.
[2025-09-15T09:40:11.714Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Haircut on Thursday, 18th September 2025 at 2:45 PM.
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}...
Message string: {"type":"History","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}
[2025-09-15T09:40:11.714Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Haircut on Thursday, 18th September 2025 at 2:45 PM."}
[2025-09-15T09:40:11.714Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Haircut on Thursday, 18th September 2025 at 2:45 PM."
}
[2025-09-15T09:40:11.714Z] === END PARSED JSON ===
[2025-09-15T09:40:11.714Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:11.714Z] üìú HISTORY: Message logged
[2025-09-15T09:40:11.714Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Haircut on Thursday, 18th September 2025 at 2:45 PM.
[2025-09-15T09:40:11.714Z] üìù Added transcript: [AI] Haircut on Thursday, 18th September 2025 at 2:45 PM.
[2025-09-15T09:40:11.714Z] üéµ Starting audio stream - feeding buffer
[2025-09-15T09:40:13.639Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:40:13.722Z] üîá Audio stream ended (timeout)
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}
[2025-09-15T09:40:17.316Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}
[2025-09-15T09:40:17.316Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "assistant",
  "content": "Is there anything else you'd like to do with these bookings?"
}
[2025-09-15T09:40:17.316Z] === END PARSED JSON ===
[2025-09-15T09:40:17.316Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:17.316Z] üí≠ CONVERSATION_TEXT: Is there anything else you'd like to do with these bookings?
[2025-09-15T09:40:17.316Z] üîç ConversationText role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Added AI: Is there anything else you'd like to do with these bookings?
üì® Received Deepgram JSON message: {"type":"History","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}...
Message string: {"type":"History","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}
[2025-09-15T09:40:17.316Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"assistant","content":"Is there anything else you'd like to do with these bookings?"}
[2025-09-15T09:40:17.316Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "assistant",
  "content": "Is there anything else you'd like to do with these bookings?"
}
[2025-09-15T09:40:17.316Z] === END PARSED JSON ===
[2025-09-15T09:40:17.316Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:17.316Z] üìú HISTORY: Message logged
[2025-09-15T09:40:17.316Z] üîç History role: 'assistant' -> Speaker: 'AI'
üìù TRANSCRIPT: Skipping duplicate AI: Is there anything else you'd like to do with these bookings?
[2025-09-15T09:40:17.316Z] üìù Added transcript: [AI] Is there anything else you'd like to do with these bookings?
[2025-09-15T09:40:17.317Z] üéµ Starting audio stream - feeding buffer
üì® Received Deepgram JSON message: {"type":"AgentAudioDone"}...
Message string: {"type":"AgentAudioDone"}
[2025-09-15T09:40:17.464Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"AgentAudioDone"}
[2025-09-15T09:40:17.464Z] === PARSED DEEPGRAM JSON ===
{
  "type": "AgentAudioDone"
}
[2025-09-15T09:40:17.464Z] === END PARSED JSON ===
[2025-09-15T09:40:17.464Z] üéØ DEEPGRAM EVENT TYPE: AgentAudioDone
[2025-09-15T09:40:17.464Z] üîá AGENT_AUDIO_DONE: AI finished sending audio
[2025-09-15T09:40:17.464Z] üîá SILENCE: Started tracking
[2025-09-15T09:40:17.464Z] ‚úÖ Agent speech ended. Pacer will now send silence until next utterance.
[2025-09-15T09:40:17.639Z] üíì KEEPALIVE: Sent to Deepgram
[2025-09-15T09:40:17.464Z] üîá SILENCE_CHECK: 999ms of silence
[2025-09-15T09:40:17.464Z] üîá SILENCE_CHECK: 2000ms of silence
[2025-09-15T09:40:17.464Z] üîá SILENCE_CHECK: 3001ms of silence
[2025-09-15T09:40:17.464Z] üîá SILENCE_CHECK: 4002ms of silence
[2025-09-15T09:40:21.639Z] üíì KEEPALIVE: Sent to Deepgram
üì® Received Deepgram JSON message: {"type":"UserStartedSpeaking"}...
Message string: {"type":"UserStartedSpeaking"}
[2025-09-15T09:40:22.115Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"UserStartedSpeaking"}
[2025-09-15T09:40:22.115Z] === PARSED DEEPGRAM JSON ===
{
  "type": "UserStartedSpeaking"
}
[2025-09-15T09:40:22.115Z] === END PARSED JSON ===
[2025-09-15T09:40:22.115Z] üéØ DEEPGRAM EVENT TYPE: UserStartedSpeaking
[2025-09-15T09:40:22.115Z] üé§ USER_STARTED_SPEAKING: User began speaking
[2025-09-15T09:40:22.115Z] üîÑ BARGE_IN: Cleared Twilio audio queue for user speech
[2025-09-15T09:40:22.115Z] üîÑ SILENCE_RESET: User speaking, silence tracking reset
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"user","content":"No. Bye."}...
Message string: {"type":"ConversationText","role":"user","content":"No. Bye."}
[2025-09-15T09:40:22.679Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"user","content":"No. Bye."}
[2025-09-15T09:40:22.679Z] === PARSED DEEPGRAM JSON ===
{
  "type": "ConversationText",
  "role": "user",
  "content": "No. Bye."
}
[2025-09-15T09:40:22.679Z] === END PARSED JSON ===
[2025-09-15T09:40:22.679Z] üéØ DEEPGRAM EVENT TYPE: ConversationText
[2025-09-15T09:40:22.679Z] üí≠ CONVERSATION_TEXT: No. Bye.
[2025-09-15T09:40:22.679Z] üîç ConversationText role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Added User: No. Bye.
üì® Received Deepgram JSON message: {"type":"History","role":"user","content":"No. Bye."}...
Message string: {"type":"History","role":"user","content":"No. Bye."}
[2025-09-15T09:40:22.688Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"History","role":"user","content":"No. Bye."}
[2025-09-15T09:40:22.688Z] === PARSED DEEPGRAM JSON ===
{
  "type": "History",
  "role": "user",
  "content": "No. Bye."
}
[2025-09-15T09:40:22.688Z] === END PARSED JSON ===
[2025-09-15T09:40:22.688Z] üéØ DEEPGRAM EVENT TYPE: History
[2025-09-15T09:40:22.688Z] üìú HISTORY: Message logged
[2025-09-15T09:40:22.688Z] üîç History role: 'user' -> Speaker: 'User'
üìù TRANSCRIPT: Skipping duplicate User: No. Bye.
[2025-09-15T09:40:22.688Z] üìù Added transcript: [User] No. Bye.
üì® Received Deepgram JSON message: {"type":"FunctionCallRequest","functions":[{"id":"call_C2G4dr6K2zWSDFrayoZj0hAA","name":"end_call","arguments":"{\"reason\":\"customer said goodbye\"}","client_side":true}]}...
Message string: {"type":"FunctionCallRequest","functions":[{"id":"call_C2G4dr6K2zWSDFrayoZj0hAA","name":"end_call","arguments":"{\"reason\":\"customer said goodbye\"}","client_side":true}]}
[2025-09-15T09:40:24.075Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"FunctionCallRequest","functions":[{"id":"call_C2G4dr6K2zWSDFrayoZj0hAA","name":"end_call","arguments":"{\"reason\":\"customer said goodbye\"}","client_side":true}]}
[2025-09-15T09:40:24.075Z] === PARSED DEEPGRAM JSON ===
{
  "type": "FunctionCallRequest",
  "functions": [
    {
      "id": "call_C2G4dr6K2zWSDFrayoZj0hAA",
      "name": "end_call",
      "arguments": "{\"reason\":\"customer said goodbye\"}",
      "client_side": true
    }
  ]
}
[2025-09-15T09:40:24.075Z] === END PARSED JSON ===
[2025-09-15T09:40:24.075Z] üéØ DEEPGRAM EVENT TYPE: FunctionCallRequest
[2025-09-15T09:40:24.075Z] üö®üö® FUNCTION_CALL_REQUEST DETECTED! üö®üö®
[2025-09-15T09:40:24.075Z] ‚úÖ SUCCESS: AI requesting function calls!
[2025-09-15T09:40:24.075Z] üìã Functions: [
  {
    "id": "call_C2G4dr6K2zWSDFrayoZj0hAA",
    "name": "end_call",
    "arguments": "{\"reason\":\"customer said goodbye\"}",
    "client_side": true
  }
]
[2025-09-15T09:40:24.075Z] ‚è∏Ô∏è SILENCE: Pausing timer - Processing function calls
[2025-09-15T09:40:24.076Z] ‚è∏Ô∏è KEEPALIVE: Paused for function processing
[2025-09-15T09:40:24.075Z] üîß Processing function: end_call
[2025-09-15T09:40:24.075Z] üîß CALLING: handleFunctionCall for end_call...
üìù Session updated for call CA20b2d8268ce7b7a3ef3351f331ad95a0: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-18',
  lastBookingTime: '14:45',
  lastServiceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
  lastServiceName: 'haircut',
  lastServiceDuration: 30,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '14:45',
      serviceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
      serviceName: 'haircut',
      serviceDuration: 30,
      appointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712',
      type: 'create'
    }
  ],
  lastAppointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712'
}
[2025-09-15T09:40:24.076Z] üöÄ STARTING handleFunctionCall
[2025-09-15T09:40:24.076Z] üîß Function call received: {
  "function_name": "end_call",
  "function_call_id": "call_C2G4dr6K2zWSDFrayoZj0hAA",
  "parameters": {
    "reason": "customer said goodbye"
  }
}
[2025-09-15T09:40:24.076Z] üìã Function name: end_call
[2025-09-15T09:40:24.076Z] üìä Parameters: {
  "reason": "customer said goodbye"
}
[2025-09-15T09:40:24.076Z] üè¢ Business config exists: true
[2025-09-15T09:40:24.076Z] üåê WebSocket state: 1
üîß Function call received: {
  "function_name": "end_call",
  "function_call_id": "call_C2G4dr6K2zWSDFrayoZj0hAA",
  "parameters": {
    "reason": "customer said goodbye"
  }
}
üìû endCall called with params: {
  "reason": "customer said goodbye"
}
üìû Call SID: CA20b2d8268ce7b7a3ef3351f331ad95a0
üìã Session data before ending call: {
  callerPhone: '+447468306825',
  customerName: 'Marco',
  lastBookingDate: '2025-09-18',
  lastBookingTime: '14:45',
  lastServiceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
  lastServiceName: 'haircut',
  lastServiceDuration: 30,
  bookings: [
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '12:30',
      serviceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      serviceName: 'beard trim',
      serviceDuration: 15,
      appointmentId: '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
      type: 'create'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-18',
      currentTime: '12:30',
      newDate: '2025-09-17',
      newTime: '12:45',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '12:45:00',
      appointmentId: 'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '12:45',
      newDate: undefined,
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: '2025-09-17',
      newTime: '14:00',
      newServiceId: undefined,
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: 'adaf6700-7750-45e7-86cb-9e42707b4654',
      serviceName: 'haircut'
    },
    {
      customerName: 'Marco',
      currentDate: '2025-09-17',
      currentTime: '14:00',
      newDate: undefined,
      newTime: undefined,
      newServiceId: '63555ab0-f0ac-48c3-a2b2-766356aeb8f4',
      type: 'update',
      finalDate: '2025-09-17',
      finalTime: '14:00:00',
      appointmentId: '4ca68442-2f04-486e-998f-9e945845cc4b',
      serviceName: 'beard trim'
    },
    {
      customerName: 'Marco',
      date: '2025-09-18',
      time: '14:45',
      serviceId: '4395775e-fa81-4a69-8425-e46c3853dea4',
      serviceName: 'haircut',
      serviceDuration: 30,
      appointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712',
      type: 'create'
    }
  ],
  lastAppointmentId: '99de44fe-c940-4b73-a60d-93c0d1ca6712'
}
üì± Sending consolidated SMS confirmation for bookings: [
  '7c6e3a32-ae3e-42c9-97db-89a86e0525c7',
  'ee2b24b5-eff8-463b-ac9e-bfcf8d803a5a',
  'adaf6700-7750-45e7-86cb-9e42707b4654',
  '4ca68442-2f04-486e-998f-9e945845cc4b',
  '99de44fe-c940-4b73-a60d-93c0d1ca6712'
]
‚úÖ Consolidated SMS sent successfully
‚úÖ Consolidated SMS confirmation sent successfully
üìû Attempting to end call with SID: CA20b2d8268ce7b7a3ef3351f331ad95a0
üìù Reason: customer said goodbye
üì® Received Deepgram JSON message: {"type":"ConversationText","role":"assistant","content":"Thank you for calling Gents Barbershop, have a great day!"}...
Message string: {"type":"ConversationText","role":"assistant","content":"Thank you for calling Gents Barbershop, have a great day!"}
[2025-09-15T09:40:26.441Z] üì® JSON MESSAGE FROM DEEPGRAM: {"type":"ConversationText","role":"assistant","content":"Thank you for calling Gents Barbershop, have a great day!"}
[2025-09-15T09:40:26.441Z] === PARSED DEEPGRAM JSON ===